{
  "{\"sourceRoot\":\"/Users/Doug/nodeprojects/vmafffmpeg/src\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/Doug/nodeprojects/vmafffmpeg\",\"filename\":\"/Users/Doug/nodeprojects/vmafffmpeg/src/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/Doug/nodeprojects/vmafffmpeg\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"regenerator-transform\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/Doug/nodeprojects/vmafffmpeg/src",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/Doug/nodeprojects/vmafffmpeg",
      "filename": "/Users/Doug/nodeprojects/vmafffmpeg/src/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/Doug/nodeprojects/vmafffmpeg",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "loose": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "loose": false
          }
        },
        {
          "key": "transform-template-literals",
          "visitor": {
            "TaggedTemplateExpression": {
              "enter": [
                null
              ]
            },
            "TemplateLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-literals",
          "visitor": {
            "NumericLiteral": {
              "enter": [
                null
              ]
            },
            "StringLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-function-name",
          "visitor": {
            "FunctionExpression": {
              "exit": [
                null
              ]
            },
            "ObjectProperty": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-arrow-functions",
          "visitor": {
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-block-scoped-functions",
          "visitor": {
            "BlockStatement": {
              "enter": [
                null
              ]
            },
            "SwitchCase": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-classes",
          "visitor": {
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            },
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-object-super",
          "visitor": {
            "ObjectExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-shorthand-properties",
          "visitor": {
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "ObjectProperty": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-duplicate-keys",
          "visitor": {
            "ObjectExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-computed-properties",
          "visitor": {
            "ObjectExpression": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-for-of",
          "visitor": {
            "ForOfStatement": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-sticky-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-dotall-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-unicode-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-spread",
          "visitor": {
            "ArrayExpression": {
              "enter": [
                null
              ]
            },
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "NewExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-parameters",
          "visitor": {
            "_exploded": true,
            "_verified": true,
            "FunctionDeclaration": {
              "enter": [
                null
              ]
            },
            "FunctionExpression": {
              "enter": [
                null
              ]
            },
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-destructuring",
          "visitor": {
            "ExportNamedDeclaration": {
              "enter": [
                null
              ]
            },
            "CatchClause": {
              "enter": [
                null
              ]
            },
            "AssignmentExpression": {
              "enter": [
                null
              ]
            },
            "VariableDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ForInStatement": {
              "enter": [
                null
              ]
            },
            "ForOfStatement": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-block-scoping",
          "visitor": {
            "VariableDeclaration": {
              "enter": [
                null
              ]
            },
            "CatchClause": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "BlockStatement": {
              "enter": [
                null
              ]
            },
            "SwitchStatement": {
              "enter": [
                null
              ]
            },
            "Program": {
              "enter": [
                null
              ]
            },
            "_verified": true,
            "DoWhileStatement": {
              "enter": [
                null
              ]
            },
            "ForInStatement": {
              "enter": [
                null
              ]
            },
            "ForStatement": {
              "enter": [
                null
              ]
            },
            "WhileStatement": {
              "enter": [
                null
              ]
            },
            "ForOfStatement": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-typeof-symbol",
          "visitor": {
            "UnaryExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "BlockStatement": {
              "enter": [
                null
              ]
            },
            "CatchClause": {
              "enter": [
                null
              ]
            },
            "DoWhileStatement": {
              "enter": [
                null
              ]
            },
            "ForInStatement": {
              "enter": [
                null
              ]
            },
            "ForStatement": {
              "enter": [
                null
              ]
            },
            "FunctionDeclaration": {
              "enter": [
                null
              ]
            },
            "FunctionExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "enter": [
                null
              ]
            },
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "SwitchStatement": {
              "enter": [
                null
              ]
            },
            "WhileStatement": {
              "enter": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            },
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ForOfStatement": {
              "enter": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ]
            },
            "TSModuleBlock": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-new-target",
          "visitor": {
            "MetaProperty": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "regenerator-transform",
          "visitor": {
            "_exploded": true,
            "_verified": true,
            "ObjectMethod": {
              "enter": [
                null
              ],
              "exit": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ],
              "exit": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ],
              "exit": [
                null
              ]
            },
            "FunctionDeclaration": {
              "exit": [
                null
              ]
            },
            "FunctionExpression": {
              "exit": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "exit": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-exponentiation-operator",
          "visitor": {
            "AssignmentExpression": {
              "enter": [
                null
              ]
            },
            "BinaryExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-async-to-generator",
          "visitor": {
            "_exploded": true,
            "_verified": true,
            "FunctionDeclaration": {
              "enter": [
                null
              ]
            },
            "FunctionExpression": {
              "enter": [
                null
              ]
            },
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-async-generator-functions",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-object-rest-spread",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "VariableDeclarator": {
              "enter": [
                null
              ]
            },
            "ExportNamedDeclaration": {
              "enter": [
                null
              ]
            },
            "CatchClause": {
              "enter": [
                null
              ]
            },
            "AssignmentExpression": {
              "enter": [
                null
              ]
            },
            "ObjectExpression": {
              "enter": [
                null
              ]
            },
            "FunctionDeclaration": {
              "enter": [
                null
              ]
            },
            "FunctionExpression": {
              "enter": [
                null
              ]
            },
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ]
            },
            "ForInStatement": {
              "enter": [
                null
              ]
            },
            "ForOfStatement": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-unicode-property-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-json-strings",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "DirectiveLiteral": {
              "enter": [
                null
              ]
            },
            "StringLiteral": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-catch-binding",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "CatchClause": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-named-capturing-groups-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-member-expression-literals",
          "visitor": {
            "MemberExpression": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-property-literals",
          "visitor": {
            "ObjectProperty": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-reserved-words",
          "visitor": {
            "_exploded": true,
            "_verified": true,
            "Identifier": {
              "enter": [
                null,
                null
              ]
            },
            "JSXIdentifier": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/Doug/nodeprojects/vmafffmpeg/src/index.js",
        "plugins": [
          "dynamicImport",
          "asyncGenerators",
          "objectRestSpread",
          "jsonStrings",
          "optionalCatchBinding"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/Doug/nodeprojects/vmafffmpeg/src/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/Doug/nodeprojects/vmafffmpeg/src",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nrequire(\"dotenv/config\");\n\nvar _cors = _interopRequireDefault(require(\"cors\"));\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _v = _interopRequireDefault(require(\"uuid/v4\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n//https://www.robinwieruch.de/minimal-node-js-babel-setup\n//great node tutorial\nvar app = (0, _express[\"default\"])();\napp.use((0, _cors[\"default\"])());\napp.use(_express[\"default\"].json());\napp.use(_express[\"default\"].urlencoded({\n  extended: true\n})); //read files\n\nvar fs = require('fs');\n\nvar path = \"../tests/\";\nvar test = {};\n\nvar spawn = require('child_process').spawn;\n\napp.get('/test', function (req, res) {\n  //get urls\n  //i exect 2 params reference url ref, test url test\n  var ref = req.query.refurl;\n  var test = req.query.testurl;\n  ref = ref.trim();\n  test = test.trim(); //create unique ID\n\n  var id = (0, _v[\"default\"])();\n  console.log(test);\n  console.log(ref); //kick off ffmpeg test\n\n  var file = \"test_\" + id + \".json\";\n  var videoJsonFile = \"json_\" + id + \".json\"; //stats on the reference video\n  //ffprobe -i <video> -hide_banner -show_format -v quiet -print_format json\n\n  var refJson = ffprobe(ref);\n  var testJson = ffprobe(test); //stats on the test video   \n  // let probeTest = spawn('ffprobe', ['-i', test, '-hide_banner', '-show_format', `-v`, 'quiet', `-print_format`, 'json']);\n  //  probeTest.stdout.on('data', (data) => {\n  //     console.log(`stdout: ${data}`);\n  //     var testJson = writeVideoData($data);\n  // });\n  //combine the json files and write to a json file\n\n  var combinedJson = \"{test:\" + testJson + \"}{reference:\" + refJson + \"} }\" > path + videoJsonFile; //compare the 2 videos\n\n  var ffmpeg = spawn('ffmpeg', ['-i', test, '-i', ref, '-lavfi', 'libvmaf=ssim=true:psnr=true:phone_model=true:log_fmt=json:log_path=' + path + file, \"-f\", 'null', '-']);\n  ffmpeg.stderr.on('data', function (err) {\n    console.log('err:', new String(err));\n  });\n  var response = {\n    id: id,\n    ref: ref,\n    refJson: refJson,\n    test: test,\n    testJson: testJson\n  };\n  return res.send(response);\n});\napp.get('/testResults', function (req, res) {\n  //i expect to get the uuid that corresponds to afilename\n  var id = req.query.id; //get the data that is stored on the server\n  //quality data\n\n  var filename = \"test_\" + id + \".json\"; //video data\n\n  var jsonFilename = \"json_\" + id + \",json\";\n  var result = fs.readFileSync(path + filename, 'utf8');\n  var json = JSON.parse(result);\n  var jsonData = JSON.parse(fs.readFileSync(path + jsonFilename, 'utf8'));\n  var returnJson = \"{ \" + jsonData + \"{VMAF:\" + json['VMAF score'] + \", PSNR:\" + json['PSNR score'] + \", SSIM:\" + json['SSIM score'] + \"}}\";\n  console.log(returnJson);\n  var response = {\n    returnJson: returnJson\n  };\n  return res.send(returnJson);\n  ;\n});\napp.listen(process.env.PORT, function () {\n  return console.log(\"Ready to process video files on port \".concat(process.env.PORT, \"!\"));\n});\n\nfunction ffprobe(videoUrl) {\n  var probe = spawn('ffprobe', ['-i', videoUrl, '-show_format', \"-v\", 'quiet', '-print_format', 'json']);\n  probe.stdout.on('data', function (data) {\n    console.log(\"stdout: \".concat(data));\n    var dataString = data.toString(); //    var jsonData = JSON.parse(dataString);\n\n    console.log(\"string: \" + dataString); //     console.log(\"JSON: \"+jsonData);\n  }); //var videoJson = JSON.parse(videoData);\n  //console.log(videoJson);\n  //var returnJson = \"{Duration: \"+videoJson.format.duration+\", Size: \"+videoJson.format.size+\", Bitrate: \"+videoJson.format.bit_rate+\"}\";\n  //return returnJson;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImFwcCIsInVzZSIsImV4cHJlc3MiLCJqc29uIiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwiZnMiLCJyZXF1aXJlIiwicGF0aCIsInRlc3QiLCJzcGF3biIsImdldCIsInJlcSIsInJlcyIsInJlZiIsInF1ZXJ5IiwicmVmdXJsIiwidGVzdHVybCIsInRyaW0iLCJpZCIsImNvbnNvbGUiLCJsb2ciLCJmaWxlIiwidmlkZW9Kc29uRmlsZSIsInJlZkpzb24iLCJmZnByb2JlIiwidGVzdEpzb24iLCJjb21iaW5lZEpzb24iLCJmZm1wZWciLCJzdGRlcnIiLCJvbiIsImVyciIsIlN0cmluZyIsInJlc3BvbnNlIiwic2VuZCIsImZpbGVuYW1lIiwianNvbkZpbGVuYW1lIiwicmVzdWx0IiwicmVhZEZpbGVTeW5jIiwiSlNPTiIsInBhcnNlIiwianNvbkRhdGEiLCJyZXR1cm5Kc29uIiwibGlzdGVuIiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJ2aWRlb1VybCIsInByb2JlIiwic3Rkb3V0IiwiZGF0YSIsImRhdGFTdHJpbmciLCJ0b1N0cmluZyJdLCJtYXBwaW5ncyI6Ijs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUxBO0FBQ0E7QUFPQSxJQUFNQSxHQUFHLEdBQUcsMEJBQVo7QUFDQUEsR0FBRyxDQUFDQyxHQUFKLENBQVEsdUJBQVI7QUFFQUQsR0FBRyxDQUFDQyxHQUFKLENBQVFDLG9CQUFRQyxJQUFSLEVBQVI7QUFDQUgsR0FBRyxDQUFDQyxHQUFKLENBQVFDLG9CQUFRRSxVQUFSLENBQW1CO0FBQUVDLEVBQUFBLFFBQVEsRUFBRTtBQUFaLENBQW5CLENBQVIsRSxDQUVBOztBQUNBLElBQUlDLEVBQUUsR0FBR0MsT0FBTyxDQUFDLElBQUQsQ0FBaEI7O0FBQ0EsSUFBSUMsSUFBSSxHQUFHLFdBQVg7QUFFQSxJQUFJQyxJQUFJLEdBQUUsRUFBVjs7QUFDQSxJQUFNQyxLQUFLLEdBQUdILE9BQU8sQ0FBQyxlQUFELENBQVAsQ0FBeUJHLEtBQXZDOztBQUdBVixHQUFHLENBQUNXLEdBQUosQ0FBUSxPQUFSLEVBQWlCLFVBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQzNCO0FBQ0E7QUFDQSxNQUFJQyxHQUFHLEdBQUdGLEdBQUcsQ0FBQ0csS0FBSixDQUFVQyxNQUFwQjtBQUNBLE1BQUlQLElBQUksR0FBR0csR0FBRyxDQUFDRyxLQUFKLENBQVVFLE9BQXJCO0FBQ0FILEVBQUFBLEdBQUcsR0FBR0EsR0FBRyxDQUFDSSxJQUFKLEVBQU47QUFDQVQsRUFBQUEsSUFBSSxHQUFHQSxJQUFJLENBQUNTLElBQUwsRUFBUCxDQU4yQixDQU8zQjs7QUFDQSxNQUFNQyxFQUFFLEdBQUcsb0JBQVg7QUFDREMsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlaLElBQVo7QUFDQ1csRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlQLEdBQVosRUFWMkIsQ0FXM0I7O0FBQ0EsTUFBSVEsSUFBSSxHQUFHLFVBQVNILEVBQVQsR0FBYSxPQUF4QjtBQUNBLE1BQUlJLGFBQWEsR0FBRyxVQUFRSixFQUFSLEdBQVcsT0FBL0IsQ0FiMkIsQ0FlOUI7QUFDQTs7QUFFQSxNQUFJSyxPQUFPLEdBQUdDLE9BQU8sQ0FBQ1gsR0FBRCxDQUFyQjtBQUNBLE1BQUlZLFFBQVEsR0FBR0QsT0FBTyxDQUFDaEIsSUFBRCxDQUF0QixDQW5COEIsQ0FzQjlCO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdFOztBQUNELE1BQUlrQixZQUFZLEdBQUcsV0FBVUQsUUFBVixHQUFtQixjQUFuQixHQUFrQ0YsT0FBbEMsR0FBMEMsS0FBMUMsR0FBa0RoQixJQUFJLEdBQUNlLGFBQTFFLENBL0I4QixDQWlDN0I7O0FBQ0EsTUFBSUssTUFBTSxHQUFHbEIsS0FBSyxDQUFDLFFBQUQsRUFBVyxDQUFDLElBQUQsRUFBT0QsSUFBUCxFQUFhLElBQWIsRUFBbUJLLEdBQW5CLEVBQXdCLFFBQXhCLEVBQWtDLHdFQUFzRU4sSUFBdEUsR0FBMkVjLElBQTdHLFFBQXlILE1BQXpILEVBQWlJLEdBQWpJLENBQVgsQ0FBbEI7QUFFR00sRUFBQUEsTUFBTSxDQUFDQyxNQUFQLENBQWNDLEVBQWQsQ0FBaUIsTUFBakIsRUFBeUIsVUFBQ0MsR0FBRCxFQUFTO0FBQzNCWCxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxNQUFaLEVBQW9CLElBQUlXLE1BQUosQ0FBV0QsR0FBWCxDQUFwQjtBQUNMLEdBRkY7QUFJRCxNQUFNRSxRQUFRLEdBQUc7QUFDZmQsSUFBQUEsRUFBRSxFQUFGQSxFQURlO0FBQ1pMLElBQUFBLEdBQUcsRUFBSEEsR0FEWTtBQUNQVSxJQUFBQSxPQUFPLEVBQVBBLE9BRE87QUFDRWYsSUFBQUEsSUFBSSxFQUFKQSxJQURGO0FBQ1FpQixJQUFBQSxRQUFRLEVBQVJBO0FBRFIsR0FBakI7QUFHQSxTQUFPYixHQUFHLENBQUNxQixJQUFKLENBQVNELFFBQVQsQ0FBUDtBQUNILENBNUNEO0FBNkNBakMsR0FBRyxDQUFDVyxHQUFKLENBQVEsY0FBUixFQUF3QixVQUFDQyxHQUFELEVBQU1DLEdBQU4sRUFBYztBQUNwQztBQUNBLE1BQUlNLEVBQUUsR0FBR1AsR0FBRyxDQUFDRyxLQUFKLENBQVVJLEVBQW5CLENBRm9DLENBR3BDO0FBQ0E7O0FBQ0EsTUFBSWdCLFFBQVEsR0FBRyxVQUFTaEIsRUFBVCxHQUFhLE9BQTVCLENBTG9DLENBTXBDOztBQUNBLE1BQUlpQixZQUFZLEdBQUcsVUFBUWpCLEVBQVIsR0FBVyxPQUE5QjtBQUNBLE1BQUlrQixNQUFNLEdBQUkvQixFQUFFLENBQUNnQyxZQUFILENBQWdCOUIsSUFBSSxHQUFFMkIsUUFBdEIsRUFBZ0MsTUFBaEMsQ0FBZDtBQUNBLE1BQUloQyxJQUFJLEdBQUdvQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0gsTUFBWCxDQUFYO0FBRUEsTUFBSUksUUFBUSxHQUFHRixJQUFJLENBQUNDLEtBQUwsQ0FBV2xDLEVBQUUsQ0FBQ2dDLFlBQUgsQ0FBZ0I5QixJQUFJLEdBQUU0QixZQUF0QixFQUFvQyxNQUFwQyxDQUFYLENBQWY7QUFFQSxNQUFJTSxVQUFVLEdBQUcsT0FBS0QsUUFBTCxHQUFjLFFBQWQsR0FBdUJ0QyxJQUFJLENBQUMsWUFBRCxDQUEzQixHQUEwQyxTQUExQyxHQUFvREEsSUFBSSxDQUFDLFlBQUQsQ0FBeEQsR0FBdUUsU0FBdkUsR0FBaUZBLElBQUksQ0FBQyxZQUFELENBQXJGLEdBQW9HLElBQXJIO0FBQ0FpQixFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWXFCLFVBQVo7QUFDQSxNQUFNVCxRQUFRLEdBQUc7QUFDYlMsSUFBQUEsVUFBVSxFQUFWQTtBQURhLEdBQWpCO0FBR0EsU0FBTzdCLEdBQUcsQ0FBQ3FCLElBQUosQ0FBU1EsVUFBVCxDQUFQO0FBQTRCO0FBQzdCLENBbkJEO0FBc0JBMUMsR0FBRyxDQUFDMkMsTUFBSixDQUFXQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsSUFBdkIsRUFBNkI7QUFBQSxTQUMzQjFCLE9BQU8sQ0FBQ0MsR0FBUixnREFBb0R1QixPQUFPLENBQUNDLEdBQVIsQ0FBWUMsSUFBaEUsT0FEMkI7QUFBQSxDQUE3Qjs7QUFLQSxTQUFTckIsT0FBVCxDQUFpQnNCLFFBQWpCLEVBQTBCO0FBQ3pCLE1BQUlDLEtBQUssR0FBR3RDLEtBQUssQ0FBQyxTQUFELEVBQVksQ0FBQyxJQUFELEVBQU9xQyxRQUFQLEVBQWlCLGNBQWpCLFFBQXVDLE9BQXZDLEVBQWdELGVBQWhELEVBQWlFLE1BQWpFLENBQVosQ0FBakI7QUFFSUMsRUFBQUEsS0FBSyxDQUFDQyxNQUFOLENBQWFuQixFQUFiLENBQWdCLE1BQWhCLEVBQXdCLFVBQUNvQixJQUFELEVBQVU7QUFDL0I5QixJQUFBQSxPQUFPLENBQUNDLEdBQVIsbUJBQXVCNkIsSUFBdkI7QUFDQSxRQUFJQyxVQUFVLEdBQUdELElBQUksQ0FBQ0UsUUFBTCxFQUFqQixDQUYrQixDQUduQzs7QUFDSWhDLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGFBQVc4QixVQUF2QixFQUorQixDQUtwQztBQUdELEdBUkcsRUFIcUIsQ0FhekI7QUFDQTtBQUNBO0FBRUc7QUFFSCIsInNvdXJjZVJvb3QiOiIvVXNlcnMvRG91Zy9ub2RlcHJvamVjdHMvdm1hZmZmbXBlZy9zcmMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2h0dHBzOi8vd3d3LnJvYmlud2llcnVjaC5kZS9taW5pbWFsLW5vZGUtanMtYmFiZWwtc2V0dXBcbi8vZ3JlYXQgbm9kZSB0dXRvcmlhbFxuaW1wb3J0ICdkb3RlbnYvY29uZmlnJztcbmltcG9ydCBjb3JzIGZyb20gJ2NvcnMnO1xuaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgdXVpZHY0IGZyb20gJ3V1aWQvdjQnO1xuXG5cbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcbmFwcC51c2UoY29ycygpKTtcblxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTtcblxuLy9yZWFkIGZpbGVzXG52YXIgZnMgPSByZXF1aXJlKCdmcycpO1xudmFyIHBhdGggPSBcIi4uL3Rlc3RzL1wiXG5cbmxldCB0ZXN0PSB7fTtcbmNvbnN0IHNwYXduID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLnNwYXduO1xuXG5cbmFwcC5nZXQoJy90ZXN0JywgKHJlcSwgcmVzKSA9PiB7XG4gICAgLy9nZXQgdXJsc1xuICAgIC8vaSBleGVjdCAyIHBhcmFtcyByZWZlcmVuY2UgdXJsIHJlZiwgdGVzdCB1cmwgdGVzdFxuICAgIGxldCByZWYgPSByZXEucXVlcnkucmVmdXJsO1xuICAgIGxldCB0ZXN0ID0gcmVxLnF1ZXJ5LnRlc3R1cmw7XG4gICAgcmVmID0gcmVmLnRyaW0oKTtcbiAgICB0ZXN0ID0gdGVzdC50cmltKCk7XG4gICAgLy9jcmVhdGUgdW5pcXVlIElEXG4gICAgY29uc3QgaWQgPSB1dWlkdjQoKTtcbiAgIGNvbnNvbGUubG9nKHRlc3QpOyAgXG4gICAgY29uc29sZS5sb2cocmVmKTtcbiAgICAvL2tpY2sgb2ZmIGZmbXBlZyB0ZXN0XG4gICAgdmFyIGZpbGUgPSBcInRlc3RfXCIgK2lkKyBcIi5qc29uXCI7XG4gICAgdmFyIHZpZGVvSnNvbkZpbGUgPSBcImpzb25fXCIraWQrXCIuanNvblwiO1xuICAgIFxuIC8vc3RhdHMgb24gdGhlIHJlZmVyZW5jZSB2aWRlb1xuIC8vZmZwcm9iZSAtaSA8dmlkZW8+IC1oaWRlX2Jhbm5lciAtc2hvd19mb3JtYXQgLXYgcXVpZXQgLXByaW50X2Zvcm1hdCBqc29uXG4gXG4gdmFyIHJlZkpzb24gPSBmZnByb2JlKHJlZik7XG4gdmFyIHRlc3RKc29uID0gZmZwcm9iZSh0ZXN0KTtcbiBcbiBcbiAvL3N0YXRzIG9uIHRoZSB0ZXN0IHZpZGVvICAgXG4vLyBsZXQgcHJvYmVUZXN0ID0gc3Bhd24oJ2ZmcHJvYmUnLCBbJy1pJywgdGVzdCwgJy1oaWRlX2Jhbm5lcicsICctc2hvd19mb3JtYXQnLCBgLXZgLCAncXVpZXQnLCBgLXByaW50X2Zvcm1hdGAsICdqc29uJ10pO1xuLy8gIHByb2JlVGVzdC5zdGRvdXQub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xuLy8gICAgIGNvbnNvbGUubG9nKGBzdGRvdXQ6ICR7ZGF0YX1gKTtcbi8vICAgICB2YXIgdGVzdEpzb24gPSB3cml0ZVZpZGVvRGF0YSgkZGF0YSk7XG4vLyB9KTtcbiBcbiBcbiAgLy9jb21iaW5lIHRoZSBqc29uIGZpbGVzIGFuZCB3cml0ZSB0byBhIGpzb24gZmlsZVxuIHZhciBjb21iaW5lZEpzb24gPSBcInt0ZXN0OlwiKyB0ZXN0SnNvbitcIn17cmVmZXJlbmNlOlwiK3JlZkpzb24rXCJ9IH1cIiA+IHBhdGgrdmlkZW9Kc29uRmlsZTtcbiAgICBcbiAgLy9jb21wYXJlIHRoZSAyIHZpZGVvc1xuICBsZXQgZmZtcGVnID0gc3Bhd24oJ2ZmbXBlZycsIFsnLWknLCB0ZXN0LCAnLWknLCByZWYsICctbGF2ZmknLCAnbGlidm1hZj1zc2ltPXRydWU6cHNucj10cnVlOnBob25lX21vZGVsPXRydWU6bG9nX2ZtdD1qc29uOmxvZ19wYXRoPScrcGF0aCtmaWxlLCBgLWZgLCAnbnVsbCcsICctJ10pO1xuICAgICBcbiAgICAgZmZtcGVnLnN0ZGVyci5vbignZGF0YScsIChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgbmV3IFN0cmluZyhlcnIpKVxuICAgICAgfSk7XG4gICAgXG4gICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICBpZCxyZWYsIHJlZkpzb24sIHRlc3QsIHRlc3RKc29uXG4gICAgfTtcbiAgICByZXR1cm4gcmVzLnNlbmQocmVzcG9uc2UpO1xufSk7XG5hcHAuZ2V0KCcvdGVzdFJlc3VsdHMnLCAocmVxLCByZXMpID0+IHtcbiAgLy9pIGV4cGVjdCB0byBnZXQgdGhlIHV1aWQgdGhhdCBjb3JyZXNwb25kcyB0byBhZmlsZW5hbWVcbiAgbGV0IGlkID0gcmVxLnF1ZXJ5LmlkO1xuICAvL2dldCB0aGUgZGF0YSB0aGF0IGlzIHN0b3JlZCBvbiB0aGUgc2VydmVyXG4gIC8vcXVhbGl0eSBkYXRhXG4gIGxldCBmaWxlbmFtZSA9IFwidGVzdF9cIiAraWQrIFwiLmpzb25cIjtcbiAgLy92aWRlbyBkYXRhXG4gIGxldCBqc29uRmlsZW5hbWUgPSBcImpzb25fXCIraWQrXCIsanNvblwiO1xuICB2YXIgcmVzdWx0ICA9IGZzLnJlYWRGaWxlU3luYyhwYXRoICtmaWxlbmFtZSwgJ3V0ZjgnKTtcbiAgdmFyIGpzb24gPSBKU09OLnBhcnNlKHJlc3VsdCk7XG4gIFxuICB2YXIganNvbkRhdGEgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYXRoICtqc29uRmlsZW5hbWUsICd1dGY4JykpO1xuICBcbiAgdmFyIHJldHVybkpzb24gPSBcInsgXCIranNvbkRhdGErXCJ7Vk1BRjpcIitqc29uWydWTUFGIHNjb3JlJ10rXCIsIFBTTlI6XCIranNvblsnUFNOUiBzY29yZSddK1wiLCBTU0lNOlwiK2pzb25bJ1NTSU0gc2NvcmUnXStcIn19XCI7XG4gIGNvbnNvbGUubG9nKHJldHVybkpzb24pO1xuICBjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIHJldHVybkpzb25cbiAgICB9O1xuICByZXR1cm4gcmVzLnNlbmQocmV0dXJuSnNvbik7O1xufSk7XG5cblxuYXBwLmxpc3Rlbihwcm9jZXNzLmVudi5QT1JULCAoKSA9PlxuICBjb25zb2xlLmxvZyhgUmVhZHkgdG8gcHJvY2VzcyB2aWRlbyBmaWxlcyBvbiBwb3J0ICR7cHJvY2Vzcy5lbnYuUE9SVH0hYCksXG4pO1xuXG5cbmZ1bmN0aW9uIGZmcHJvYmUodmlkZW9Vcmwpe1xuXHRsZXQgcHJvYmUgPSBzcGF3bignZmZwcm9iZScsIFsnLWknLCB2aWRlb1VybCwgJy1zaG93X2Zvcm1hdCcsIGAtdmAsICdxdWlldCcsICctcHJpbnRfZm9ybWF0JywgJ2pzb24nXSk7XG4gXG4gICAgIHByb2JlLnN0ZG91dC5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBzdGRvdXQ6ICR7ZGF0YX1gKTtcbiAgICAgICAgdmFyIGRhdGFTdHJpbmcgPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgLy8gICAgdmFyIGpzb25EYXRhID0gSlNPTi5wYXJzZShkYXRhU3RyaW5nKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJzdHJpbmc6IFwiK2RhdGFTdHJpbmcpO1xuICAgLy8gICAgIGNvbnNvbGUubG9nKFwiSlNPTjogXCIranNvbkRhdGEpO1xuICAgICAgICBcbiAgICAgICAgXG4gfSk7XG5cdFxuXHQvL3ZhciB2aWRlb0pzb24gPSBKU09OLnBhcnNlKHZpZGVvRGF0YSk7XG5cdC8vY29uc29sZS5sb2codmlkZW9Kc29uKTtcblx0Ly92YXIgcmV0dXJuSnNvbiA9IFwie0R1cmF0aW9uOiBcIit2aWRlb0pzb24uZm9ybWF0LmR1cmF0aW9uK1wiLCBTaXplOiBcIit2aWRlb0pzb24uZm9ybWF0LnNpemUrXCIsIEJpdHJhdGU6IFwiK3ZpZGVvSnNvbi5mb3JtYXQuYml0X3JhdGUrXCJ9XCI7XG5cbiAgICAvL3JldHVybiByZXR1cm5Kc29uO1xuXG59XG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "app",
        "use",
        "express",
        "json",
        "urlencoded",
        "extended",
        "fs",
        "require",
        "path",
        "test",
        "spawn",
        "get",
        "req",
        "res",
        "ref",
        "query",
        "refurl",
        "testurl",
        "trim",
        "id",
        "console",
        "log",
        "file",
        "videoJsonFile",
        "refJson",
        "ffprobe",
        "testJson",
        "combinedJson",
        "ffmpeg",
        "stderr",
        "on",
        "err",
        "String",
        "response",
        "send",
        "filename",
        "jsonFilename",
        "result",
        "readFileSync",
        "JSON",
        "parse",
        "jsonData",
        "returnJson",
        "listen",
        "process",
        "env",
        "PORT",
        "videoUrl",
        "probe",
        "stdout",
        "data",
        "dataString",
        "toString"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/Doug/nodeprojects/vmafffmpeg/src",
      "sourcesContent": [
        "//https://www.robinwieruch.de/minimal-node-js-babel-setup\n//great node tutorial\nimport 'dotenv/config';\nimport cors from 'cors';\nimport express from 'express';\nimport uuidv4 from 'uuid/v4';\n\n\nconst app = express();\napp.use(cors());\n\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\n\n//read files\nvar fs = require('fs');\nvar path = \"../tests/\"\n\nlet test= {};\nconst spawn = require('child_process').spawn;\n\n\napp.get('/test', (req, res) => {\n    //get urls\n    //i exect 2 params reference url ref, test url test\n    let ref = req.query.refurl;\n    let test = req.query.testurl;\n    ref = ref.trim();\n    test = test.trim();\n    //create unique ID\n    const id = uuidv4();\n   console.log(test);  \n    console.log(ref);\n    //kick off ffmpeg test\n    var file = \"test_\" +id+ \".json\";\n    var videoJsonFile = \"json_\"+id+\".json\";\n    \n //stats on the reference video\n //ffprobe -i <video> -hide_banner -show_format -v quiet -print_format json\n \n var refJson = ffprobe(ref);\n var testJson = ffprobe(test);\n \n \n //stats on the test video   \n// let probeTest = spawn('ffprobe', ['-i', test, '-hide_banner', '-show_format', `-v`, 'quiet', `-print_format`, 'json']);\n//  probeTest.stdout.on('data', (data) => {\n//     console.log(`stdout: ${data}`);\n//     var testJson = writeVideoData($data);\n// });\n \n \n  //combine the json files and write to a json file\n var combinedJson = \"{test:\"+ testJson+\"}{reference:\"+refJson+\"} }\" > path+videoJsonFile;\n    \n  //compare the 2 videos\n  let ffmpeg = spawn('ffmpeg', ['-i', test, '-i', ref, '-lavfi', 'libvmaf=ssim=true:psnr=true:phone_model=true:log_fmt=json:log_path='+path+file, `-f`, 'null', '-']);\n     \n     ffmpeg.stderr.on('data', (err) => {\n            console.log('err:', new String(err))\n      });\n    \n    const response = {\n      id,ref, refJson, test, testJson\n    };\n    return res.send(response);\n});\napp.get('/testResults', (req, res) => {\n  //i expect to get the uuid that corresponds to afilename\n  let id = req.query.id;\n  //get the data that is stored on the server\n  //quality data\n  let filename = \"test_\" +id+ \".json\";\n  //video data\n  let jsonFilename = \"json_\"+id+\",json\";\n  var result  = fs.readFileSync(path +filename, 'utf8');\n  var json = JSON.parse(result);\n  \n  var jsonData = JSON.parse(fs.readFileSync(path +jsonFilename, 'utf8'));\n  \n  var returnJson = \"{ \"+jsonData+\"{VMAF:\"+json['VMAF score']+\", PSNR:\"+json['PSNR score']+\", SSIM:\"+json['SSIM score']+\"}}\";\n  console.log(returnJson);\n  const response = {\n      returnJson\n    };\n  return res.send(returnJson);;\n});\n\n\napp.listen(process.env.PORT, () =>\n  console.log(`Ready to process video files on port ${process.env.PORT}!`),\n);\n\n\nfunction ffprobe(videoUrl){\n\tlet probe = spawn('ffprobe', ['-i', videoUrl, '-show_format', `-v`, 'quiet', '-print_format', 'json']);\n \n     probe.stdout.on('data', (data) => {\n        console.log(`stdout: ${data}`);\n        var dataString = data.toString();\n    //    var jsonData = JSON.parse(dataString);\n        console.log(\"string: \"+dataString);\n   //     console.log(\"JSON: \"+jsonData);\n        \n        \n });\n\t\n\t//var videoJson = JSON.parse(videoData);\n\t//console.log(videoJson);\n\t//var returnJson = \"{Duration: \"+videoJson.format.duration+\", Size: \"+videoJson.format.size+\", Bitrate: \"+videoJson.format.bit_rate+\"}\";\n\n    //return returnJson;\n\n}\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1567319404000
  },
  "{\"sourceRoot\":\"/Users/Doug/Documents/Github/VideoQuality/vmafscan/src\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/Doug/Documents/Github/VideoQuality/vmafscan\",\"filename\":\"/Users/Doug/Documents/Github/VideoQuality/vmafscan/src/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/Doug/Documents/Github/VideoQuality/vmafscan\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"regenerator-transform\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/Doug/Documents/Github/VideoQuality/vmafscan/src",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/Doug/Documents/Github/VideoQuality/vmafscan",
      "filename": "/Users/Doug/Documents/Github/VideoQuality/vmafscan/src/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/Doug/Documents/Github/VideoQuality/vmafscan",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "loose": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "loose": false
          }
        },
        {
          "key": "transform-template-literals",
          "visitor": {
            "TaggedTemplateExpression": {
              "enter": [
                null
              ]
            },
            "TemplateLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-literals",
          "visitor": {
            "NumericLiteral": {
              "enter": [
                null
              ]
            },
            "StringLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-function-name",
          "visitor": {
            "FunctionExpression": {
              "exit": [
                null
              ]
            },
            "ObjectProperty": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-arrow-functions",
          "visitor": {
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-block-scoped-functions",
          "visitor": {
            "BlockStatement": {
              "enter": [
                null
              ]
            },
            "SwitchCase": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-classes",
          "visitor": {
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            },
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-object-super",
          "visitor": {
            "ObjectExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-shorthand-properties",
          "visitor": {
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "ObjectProperty": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-duplicate-keys",
          "visitor": {
            "ObjectExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-computed-properties",
          "visitor": {
            "ObjectExpression": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-for-of",
          "visitor": {
            "ForOfStatement": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-sticky-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-dotall-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-unicode-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-spread",
          "visitor": {
            "ArrayExpression": {
              "enter": [
                null
              ]
            },
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "NewExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-parameters",
          "visitor": {
            "_exploded": true,
            "_verified": true,
            "FunctionDeclaration": {
              "enter": [
                null
              ]
            },
            "FunctionExpression": {
              "enter": [
                null
              ]
            },
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-destructuring",
          "visitor": {
            "ExportNamedDeclaration": {
              "enter": [
                null
              ]
            },
            "CatchClause": {
              "enter": [
                null
              ]
            },
            "AssignmentExpression": {
              "enter": [
                null
              ]
            },
            "VariableDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ForInStatement": {
              "enter": [
                null
              ]
            },
            "ForOfStatement": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-block-scoping",
          "visitor": {
            "VariableDeclaration": {
              "enter": [
                null
              ]
            },
            "CatchClause": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "BlockStatement": {
              "enter": [
                null
              ]
            },
            "SwitchStatement": {
              "enter": [
                null
              ]
            },
            "Program": {
              "enter": [
                null
              ]
            },
            "_verified": true,
            "DoWhileStatement": {
              "enter": [
                null
              ]
            },
            "ForInStatement": {
              "enter": [
                null
              ]
            },
            "ForStatement": {
              "enter": [
                null
              ]
            },
            "WhileStatement": {
              "enter": [
                null
              ]
            },
            "ForOfStatement": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-typeof-symbol",
          "visitor": {
            "UnaryExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "BlockStatement": {
              "enter": [
                null
              ]
            },
            "CatchClause": {
              "enter": [
                null
              ]
            },
            "DoWhileStatement": {
              "enter": [
                null
              ]
            },
            "ForInStatement": {
              "enter": [
                null
              ]
            },
            "ForStatement": {
              "enter": [
                null
              ]
            },
            "FunctionDeclaration": {
              "enter": [
                null
              ]
            },
            "FunctionExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "enter": [
                null
              ]
            },
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "SwitchStatement": {
              "enter": [
                null
              ]
            },
            "WhileStatement": {
              "enter": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            },
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ForOfStatement": {
              "enter": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ]
            },
            "TSModuleBlock": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-new-target",
          "visitor": {
            "MetaProperty": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "regenerator-transform",
          "visitor": {
            "_exploded": true,
            "_verified": true,
            "ObjectMethod": {
              "enter": [
                null
              ],
              "exit": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ],
              "exit": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ],
              "exit": [
                null
              ]
            },
            "FunctionDeclaration": {
              "exit": [
                null
              ]
            },
            "FunctionExpression": {
              "exit": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "exit": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-exponentiation-operator",
          "visitor": {
            "AssignmentExpression": {
              "enter": [
                null
              ]
            },
            "BinaryExpression": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-async-to-generator",
          "visitor": {
            "_exploded": true,
            "_verified": true,
            "FunctionDeclaration": {
              "enter": [
                null
              ]
            },
            "FunctionExpression": {
              "enter": [
                null
              ]
            },
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-async-generator-functions",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-object-rest-spread",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "VariableDeclarator": {
              "enter": [
                null
              ]
            },
            "ExportNamedDeclaration": {
              "enter": [
                null
              ]
            },
            "CatchClause": {
              "enter": [
                null
              ]
            },
            "AssignmentExpression": {
              "enter": [
                null
              ]
            },
            "ObjectExpression": {
              "enter": [
                null
              ]
            },
            "FunctionDeclaration": {
              "enter": [
                null
              ]
            },
            "FunctionExpression": {
              "enter": [
                null
              ]
            },
            "ObjectMethod": {
              "enter": [
                null
              ]
            },
            "ArrowFunctionExpression": {
              "enter": [
                null
              ]
            },
            "ClassMethod": {
              "enter": [
                null
              ]
            },
            "ClassPrivateMethod": {
              "enter": [
                null
              ]
            },
            "ForInStatement": {
              "enter": [
                null
              ]
            },
            "ForOfStatement": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-unicode-property-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-json-strings",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "DirectiveLiteral": {
              "enter": [
                null
              ]
            },
            "StringLiteral": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-catch-binding",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "CatchClause": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-named-capturing-groups-regex",
          "visitor": {
            "RegExpLiteral": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-member-expression-literals",
          "visitor": {
            "MemberExpression": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-property-literals",
          "visitor": {
            "ObjectProperty": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-reserved-words",
          "visitor": {
            "_exploded": true,
            "_verified": true,
            "Identifier": {
              "enter": [
                null,
                null
              ]
            },
            "JSXIdentifier": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/Doug/Documents/Github/VideoQuality/vmafscan/src/index.js",
        "plugins": [
          "dynamicImport",
          "asyncGenerators",
          "objectRestSpread",
          "jsonStrings",
          "optionalCatchBinding"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/Doug/Documents/Github/VideoQuality/vmafscan/src/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/Doug/Documents/Github/VideoQuality/vmafscan/src",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nrequire(\"dotenv/config\");\n\nvar _cors = _interopRequireDefault(require(\"cors\"));\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _v = _interopRequireDefault(require(\"uuid/v4\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n//https://www.robinwieruch.de/minimal-node-js-babel-setup\n//great node tutorial\nvar pug = require('pug'); //bull for queuing the vmaf ffmpeg jons\n\n\nvar Queue = require('bull');\n\nvar favicon = require('serve-favicon');\n\nvar app = (0, _express[\"default\"])();\napp.use(favicon('public/icon.ico'));\napp.use((0, _cors[\"default\"])());\napp.use(_express[\"default\"].json());\napp.use(_express[\"default\"].urlencoded({\n  extended: true\n}));\napp.set('view engine', 'pug');\napp.use(_express[\"default\"][\"static\"]('public/')); //read files\n\nvar fs = require('fs'); //var http = require('http');\n//var https = require('https');\n\n\nvar path = \"../tests/\";\nvar parsedTotalJson = \"\";\nvar test = {};\n\nvar spawn = require('child_process').spawn; //create the video queue\n//queue allows 2 jobs at a time\n\n\nvar videoQualityQueue = new Queue('ffmpeg-processing-qualityMetrics', {\n  limiter: {\n    max: 1,\n    duration: 1000\n  }\n});\nvar concurrency = 1;\nvideoQualityQueue.process(concurrency, function (job, done) {\n  var jobString = JSON.stringify(job);\n  var file = \"test_\" + job.data.fileID + \".json\";\n  console.log(path + file);\n  var ffmpegPromise = new Promise(function (resolve, reject) {\n    try {\n      var ffmpeg = spawn('ffmpeg', ['-i', job.data.testUrl, '-i', job.data.refUrl, '-filter_complex', '[0:v]scale=' + job.data.refVideoWidth + 'x' + job.data.refVideoHeight + ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:phone_model=true:log_fmt=json:log_path=' + path + file, \"-f\", 'null', '-']);\n      console.log(\"running test id:\" + job.data.fileID);\n      ffmpeg.stderr.on('data', function (err) {\n        console.log('err:', new String(err));\n      });\n      ffmpeg.stdout.on('data', function () {\n        console.log('stdout');\n        resolve(\"success!\");\n      });\n    } catch (Exception) {\n      reject(\"error in promise\");\n    }\n  });\n  return ffmpegPromise.then(function (successMessage) {\n    console.log(successMessage);\n    done();\n  });\n});\napp.get('/', function (req, res) {\n  return res.render('landing');\n});\napp.get('/probe', function (req, res) {\n  var url = req.query.url;\n  console.log(\"testurl=\" + url);\n  var probeJson = new Promise(function (resolve, reject) {\n    try {\n      ffprobe(url, function (result) {\n        //create combined JSON file\n        var resultJson = result;\n        resolve(resultJson);\n      });\n    } catch (Exception) {\n      reject(\"error in ffprobe promise\");\n    }\n  });\n  probeJson.then(function (value) {\n    //     console.log(\"total json promise:\"+ totalJson);\n    //compare the 2 videos\n    //no longer have to be the same size!!!\n    var parsedprobeJson = JSON.parse(value);\n    console.log(\"parsed json\" + value); //const response = {parsedprobeJson};\n\n    return res.status(200).send(parsedprobeJson);\n  });\n});\napp.get('/test', function (req, res) {\n  //get urls\n  //i exect 2 params reference url ref, test url test\n  var ref = req.query.refurl;\n  var test = req.query.testurl;\n  var api = false;\n\n  if (req.query.api == \"false\") {\n    api = false;\n  } else if (req.query.api == \"true\") {\n    api = true;\n  }\n\n  var testPriority = 5;\n\n  if (req.query.pri !== {}) {\n    testPriority = req.query.pri;\n  } //console.log(\"api: \" +api);\n  //create unique ID\n\n\n  var id = (0, _v[\"default\"])(); //get ffprobe format data of both files, and then run the vmaf comparison \n\n  var totalJson = \"\";\n  var jsonCombinedPromise = new Promise(function (resolve, reject) {\n    try {\n      ffprobe(ref, function (refresult) {\n        ffprobe(test, function (testresult) {\n          //create combined JSON file\n          var combinedJson = \"{\\\"test\\\":\" + testresult + \",\\\"reference\\\":\" + refresult + \"}\";\n          resolve(combinedJson);\n        });\n      });\n    } catch (Exception) {\n      reject(\"error in ffprobe promise\");\n    }\n  });\n  jsonCombinedPromise.then(function (value) {\n    totalJson = value; //  console.log(\"total json promise:\"+ totalJson);\n    //compare the 2 videos\n    //no longer have to be the same size!!!\n\n    parsedTotalJson = JSON.parse(totalJson);\n    console.log(parsedTotalJson);\n    var streamCount = parsedTotalJson['reference']['streams'].length;\n    var refWidth = 0;\n    var refHeight = 0;\n    var testWidth = 0;\n    var testHeight = 0;\n\n    for (var i = 0; i < streamCount; i++) {\n      if (parsedTotalJson['reference']['streams'][i]['codec_type'] == \"video\") {\n        refWidth = parsedTotalJson['reference']['streams'][i]['width'];\n        refHeight = parsedTotalJson['reference']['streams'][i]['height'];\n        console.log(\"ref: \" + refHeight + \" x\" + refWidth);\n      }\n\n      if (parsedTotalJson['test']['streams'][i]['codec_type'] == \"video\") {\n        testWidth = parsedTotalJson['test']['streams'][i]['width'];\n        testHeight = parsedTotalJson['test']['streams'][i]['height'];\n        console.log(\"test: \" + testHeight + \" x\" + testWidth);\n      }\n    } //console.log('ref video is (hxw):'+refHeight+refWidth);\n    //add video to the queue for quality scoring\n\n\n    var job = videoQualityQueue.add({\n      fileID: id,\n      testUrl: test,\n      refUrl: ref,\n      refVideoHeight: refHeight,\n      refVideoWidth: refWidth\n    }, {\n      priority: testPriority\n    });\n    totalJson = JSON.parse(totalJson);\n    var statusCode = 100;\n\n    if (api === true) {\n      var response = {\n        id: id,\n        statusCode: statusCode,\n        refHeight: refHeight,\n        refWidth: refWidth,\n        testWidth: testWidth,\n        testHeight: testHeight,\n        totalJson: totalJson\n      }; //send a 100 meaning that the test is in process\n\n      return res.status(200).send(response);\n    } else {\n      //build a page \t\t \n      return res.render('index', {\n        id: id,\n        statusCode: statusCode,\n        refHeight: refHeight,\n        refWidth: refWidth,\n        testWidth: testWidth,\n        testHeight: testHeight,\n        totalJson: totalJson\n      });\n    }\n  });\n});\napp.get('/testResults', function (req, res) {\n  //i expect to get the uuid that corresponds to afilename\n  var id = req.query.id;\n  var api = false;\n\n  if (req.query.api == \"false\") {\n    api = false;\n  } else if (req.query.api == \"true\") {\n    api = true;\n  } //get the data that is stored on the server\n  //quality data\n\n\n  var filename = \"test_\" + id + \".json\";\n  var result;\n\n  try {\n    result = fs.readFileSync(path + filename, 'utf8');\n  } catch (err) {\n    // no file found - not ready yet\n    var inProgress = JSON.parse(\"{\\\"statusCode\\\": 101, \\\"status\\\": \\\"Still processing. Try Again in a few minutes.\\\"}\");\n    return res.status(200).send(inProgress);\n  }\n\n  var json = JSON.parse(result);\n  var videojson = JSON.stringify(parsedTotalJson); // console.log(videojson);\n\n  var statusCode = 200;\n  var VMAF = json['VMAF score'];\n  var PSNR = json['PSNR score'];\n  var SSIM = json['SSIM score'];\n  var returnJson = \"{\\\"VMAF\\\":\" + json['VMAF score'] + \", \\\"PSNR\\\":\" + json['PSNR score'] + \", \\\"SSIM\\\":\" + json['SSIM score'] + \"}\";\n  returnJson = JSON.parse(returnJson); //console.log(returnJson);\n\n  var statusCode = 200;\n\n  if (api) {\n    var response = {\n      id: id,\n      statusCode: statusCode,\n      VMAF: VMAF,\n      PSNR: PSNR,\n      SSIM: SSIM\n    };\n    return res.status(200).send(response);\n  } else {\n    //build a page \t\t \n    return res.render('results', {\n      id: id,\n      statusCode: statusCode,\n      VMAF: VMAF,\n      PSNR: PSNR,\n      SSIM: SSIM\n    });\n  }\n});\napp.listen(1437, function () {\n  return console.log(\"Ready to process video files on port 1437!\");\n});\n\nfunction ffprobe(videoUrl, callback) {\n  var dataString = \"\";\n  var probe = spawn('ffprobe', ['-i', videoUrl, '-show_format', '-show_streams', \"-v\", 'quiet', '-print_format', 'json']); // console.log(\"ffprobe\" + videoUrl);\n\n  probe.stdout.on('data', function (data) {\n    // console.log(\"debugging DL\" +data.length);     \t\n    dataString += data.toString();\n    console.log(dataString);\n  });\n  probe.on('close', function (code) {\n    //console.log(\"close: \"+ dataString);\n    return callback(dataString);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInB1ZyIsInJlcXVpcmUiLCJRdWV1ZSIsImZhdmljb24iLCJhcHAiLCJ1c2UiLCJleHByZXNzIiwianNvbiIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsInNldCIsImZzIiwicGF0aCIsInBhcnNlZFRvdGFsSnNvbiIsInRlc3QiLCJzcGF3biIsInZpZGVvUXVhbGl0eVF1ZXVlIiwibGltaXRlciIsIm1heCIsImR1cmF0aW9uIiwiY29uY3VycmVuY3kiLCJwcm9jZXNzIiwiam9iIiwiZG9uZSIsImpvYlN0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJmaWxlIiwiZGF0YSIsImZpbGVJRCIsImNvbnNvbGUiLCJsb2ciLCJmZm1wZWdQcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmZm1wZWciLCJ0ZXN0VXJsIiwicmVmVXJsIiwicmVmVmlkZW9XaWR0aCIsInJlZlZpZGVvSGVpZ2h0Iiwic3RkZXJyIiwib24iLCJlcnIiLCJTdHJpbmciLCJzdGRvdXQiLCJFeGNlcHRpb24iLCJ0aGVuIiwic3VjY2Vzc01lc3NhZ2UiLCJnZXQiLCJyZXEiLCJyZXMiLCJyZW5kZXIiLCJ1cmwiLCJxdWVyeSIsInByb2JlSnNvbiIsImZmcHJvYmUiLCJyZXN1bHQiLCJyZXN1bHRKc29uIiwidmFsdWUiLCJwYXJzZWRwcm9iZUpzb24iLCJwYXJzZSIsInN0YXR1cyIsInNlbmQiLCJyZWYiLCJyZWZ1cmwiLCJ0ZXN0dXJsIiwiYXBpIiwidGVzdFByaW9yaXR5IiwicHJpIiwiaWQiLCJ0b3RhbEpzb24iLCJqc29uQ29tYmluZWRQcm9taXNlIiwicmVmcmVzdWx0IiwidGVzdHJlc3VsdCIsImNvbWJpbmVkSnNvbiIsInN0cmVhbUNvdW50IiwibGVuZ3RoIiwicmVmV2lkdGgiLCJyZWZIZWlnaHQiLCJ0ZXN0V2lkdGgiLCJ0ZXN0SGVpZ2h0IiwiaSIsImFkZCIsInByaW9yaXR5Iiwic3RhdHVzQ29kZSIsInJlc3BvbnNlIiwiZmlsZW5hbWUiLCJyZWFkRmlsZVN5bmMiLCJpblByb2dyZXNzIiwidmlkZW9qc29uIiwiVk1BRiIsIlBTTlIiLCJTU0lNIiwicmV0dXJuSnNvbiIsImxpc3RlbiIsInZpZGVvVXJsIiwiY2FsbGJhY2siLCJkYXRhU3RyaW5nIiwicHJvYmUiLCJ0b1N0cmluZyIsImNvZGUiXSwibWFwcGluZ3MiOiI7O0FBR0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFOQTtBQUNBO0FBT0EsSUFBTUEsR0FBRyxHQUFHQyxPQUFPLENBQUMsS0FBRCxDQUFuQixDLENBQ0E7OztBQUNBLElBQUlDLEtBQUssR0FBR0QsT0FBTyxDQUFDLE1BQUQsQ0FBbkI7O0FBQ0EsSUFBSUUsT0FBTyxHQUFHRixPQUFPLENBQUMsZUFBRCxDQUFyQjs7QUFDQSxJQUFNRyxHQUFHLEdBQUcsMEJBQVo7QUFDQUEsR0FBRyxDQUFDQyxHQUFKLENBQVFGLE9BQU8sQ0FBQyxpQkFBRCxDQUFmO0FBQ0FDLEdBQUcsQ0FBQ0MsR0FBSixDQUFRLHVCQUFSO0FBQ0FELEdBQUcsQ0FBQ0MsR0FBSixDQUFRQyxvQkFBUUMsSUFBUixFQUFSO0FBQ0FILEdBQUcsQ0FBQ0MsR0FBSixDQUFRQyxvQkFBUUUsVUFBUixDQUFtQjtBQUFFQyxFQUFBQSxRQUFRLEVBQUU7QUFBWixDQUFuQixDQUFSO0FBQ0FMLEdBQUcsQ0FBQ00sR0FBSixDQUFRLGFBQVIsRUFBc0IsS0FBdEI7QUFDQU4sR0FBRyxDQUFDQyxHQUFKLENBQVFDLDhCQUFlLFNBQWYsQ0FBUixFLENBR0E7O0FBQ0EsSUFBSUssRUFBRSxHQUFHVixPQUFPLENBQUMsSUFBRCxDQUFoQixDLENBQ0E7QUFDQTs7O0FBRUEsSUFBSVcsSUFBSSxHQUFHLFdBQVg7QUFDQSxJQUFJQyxlQUFlLEdBQUMsRUFBcEI7QUFDQSxJQUFJQyxJQUFJLEdBQUUsRUFBVjs7QUFDQSxJQUFNQyxLQUFLLEdBQUdkLE9BQU8sQ0FBQyxlQUFELENBQVAsQ0FBeUJjLEtBQXZDLEMsQ0FFQTtBQUNBOzs7QUFDQSxJQUFNQyxpQkFB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WCxFQUFpQjtBQUFBLFNBQ2ZqRSxPQUFPLENBQUNDLEdBQVIsOENBRGU7QUFBQSxDQUFqQjs7QUFLQSxTQUFTeUIsT0FBVCxDQUFpQndDLFFBQWpCLEVBQTJCQyxRQUEzQixFQUFvQztBQUNuQyxNQUFJQyxVQUFVLEdBQUcsRUFBakI7QUFDQSxNQUFJQyxLQUFLLEdBQUdwRixLQUFLLENBQUMsU0FBRCxFQUFZLENBQUMsSUFBRCxFQUFPaUYsUUFBUCxFQUFpQixjQUFqQixFQUFnQyxlQUFoQyxRQUF1RCxPQUF2RCxFQUFnRSxlQUFoRSxFQUFpRixNQUFqRixDQUFaLENBQWpCLENBRm1DLENBR2hDOztBQUNDRyxFQUFBQSxLQUFLLENBQUN0RCxNQUFOLENBQWFILEVBQWIsQ0FBZ0IsTUFBaEIsRUFBd0IsVUFBQ2QsSUFBRCxFQUFVO0FBQ2hDO0FBQ0NzRSxJQUFBQSxVQUFVLElBQUl0RSxJQUFJLENBQUN3RSxRQUFMLEVBQWQ7QUFDTnRFLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZbUUsVUFBWjtBQUNDLEdBSkU7QUFLSEMsRUFBQUEsS0FBSyxDQUFDekQsRUFBTixDQUFTLE9BQVQsRUFBa0IsVUFBUzJELElBQVQsRUFBZTtBQUNoQztBQUNLLFdBQU9KLFFBQVEsQ0FBQ0MsVUFBRCxDQUFmO0FBQ0gsR0FISDtBQUtEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9Eb3VnL0RvY3VtZW50cy9HaXRodWIvVmlkZW9RdWFsaXR5L3ZtYWZzY2FuL3NyYyIsInNvdXJjZXNDb250ZW50IjpbIi8vaHR0cHM6Ly93d3cucm9iaW53aWVydWNoLmRlL21pbmltYWwtbm9kZS1qcy1iYWJlbC1zZXR1cFxuLy9ncmVhdCBub2RlIHR1dG9yaWFsXG5cbmltcG9ydCAnZG90ZW52L2NvbmZpZyc7XG5pbXBvcnQgY29ycyBmcm9tICdjb3JzJztcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHV1aWR2NCBmcm9tICd1dWlkL3Y0JztcblxuY29uc3QgcHVnID0gcmVxdWlyZSgncHVnJyk7XG4vL2J1bGwgZm9yIHF1ZXVpbmcgdGhlIHZtYWYgZmZtcGVnIGpvbnNcbnZhciBRdWV1ZSA9IHJlcXVpcmUoJ2J1bGwnKTtcbnZhciBmYXZpY29uID0gcmVxdWlyZSgnc2VydmUtZmF2aWNvbicpO1xuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuYXBwLnVzZShmYXZpY29uKCdwdWJsaWMvaWNvbi5pY28nKSk7IFxuYXBwLnVzZShjb3JzKCkpO1xuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTtcbmFwcC5zZXQoJ3ZpZXcgZW5naW5lJywncHVnJyk7XG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKCdwdWJsaWMvJykpO1xuXG5cbi8vcmVhZCBmaWxlc1xudmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcbi8vdmFyIGh0dHAgPSByZXF1aXJlKCdodHRwJyk7XG4vL3ZhciBodHRwcyA9IHJlcXVpcmUoJ2h0dHBzJyk7XG5cbnZhciBwYXRoID0gXCIuLi90ZXN0cy9cIlxudmFyIHBhcnNlZFRvdGFsSnNvbj1cIlwiO1xubGV0IHRlc3Q9IHt9O1xuY29uc3Qgc3Bhd24gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuc3Bhd247XG5cbi8vY3JlYXRlIHRoZSB2aWRlbyBxdWV1ZVxuLy9xdWV1ZSBhbGxvd3MgMiBqb2JzIGF0IGEgdGltZVxuY29uc3QgdmlkZW9RdWFsaXR5UXVldWUgPSBuZXcgUXVldWUoJ2ZmbXBlZy1wcm9jZXNzaW5nLXF1YWxpdHlNZXRyaWNzJywge1xuICBsaW1pdGVyOiB7XG4gICAgbWF4OiAxLCBcbiAgICBkdXJhdGlvbjogMTAwMFxuICB9XG59KTtcblxuY29uc3QgY29uY3VycmVuY3kgPSAxO1xudmlkZW9RdWFsaXR5UXVldWUucHJvY2Vzcyhjb25jdXJyZW5jeSwgZnVuY3Rpb24oam9iLCBkb25lKSB7XG4gICAgdmFyIGpvYlN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGpvYik7XG4gICAgdmFyIGZpbGUgPSBcInRlc3RfXCIgK2pvYi5kYXRhLmZpbGVJRCsgXCIuanNvblwiO1xuICAgIGNvbnNvbGUubG9nKHBhdGgrZmlsZSk7XG4gICAgdmFyIGZmbXBlZ1Byb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgIHRyeSB7XG4gICAgXHRcdGxldCBmZm1wZWcgPSBzcGF3bignZmZtcGVnJywgWyctaScsIGpvYi5kYXRhLnRlc3RVcmwsICctaScsIGpvYi5kYXRhLnJlZlVybCwgJy1maWx0ZXJfY29tcGxleCcsICdbMDp2XXNjYWxlPScram9iLmRhdGEucmVmVmlkZW9XaWR0aCsneCcram9iLmRhdGEucmVmVmlkZW9IZWlnaHQrJzpmbGFncz1iaWN1YmljW21haW5dO1ttYWluXVsxOnZdbGlidm1hZj1zc2ltPXRydWU6cHNucj10cnVlOnBob25lX21vZGVsPXRydWU6bG9nX2ZtdD1qc29uOmxvZ19wYXRoPScrcGF0aCtmaWxlLCBgLWZgLCAnbnVsbCcsICctJ10pO1xuICAgIFx0XHRjb25zb2xlLmxvZyhcInJ1bm5pbmcgdGVzdCBpZDpcIiAram9iLmRhdGEuZmlsZUlEKTsgXG4gICAgXHRcdGZmbXBlZy5zdGRlcnIub24oJ2RhdGEnLCAoZXJyKSA9PiB7XG4gICAgICAgICAgICBcdGNvbnNvbGUubG9nKCdlcnI6JywgbmV3IFN0cmluZyhlcnIpKTtcbiAgICAgICAgICAgIFx0XG4gICAgXHRcdH0pO1xuICAgIFx0XHRmZm1wZWcuc3Rkb3V0Lm9uKCdkYXRhJywgZnVuY3Rpb24oKXsgXG4gICAgXHRcdFx0XHRjb25zb2xlLmxvZygnc3Rkb3V0Jyk7XG4gICAgXHRcdFx0XHRyZXNvbHZlKFwic3VjY2VzcyFcIik7XG4gICAgXHRcdFx0XHRcbiAgICBcdFx0IH0pOyBcbiAgICBcdCAgfVxuICAgIFx0ICBjYXRjaCAoRXhjZXB0aW9uKXsgXG4gICAgXHRcdFx0cmVqZWN0KFwiZXJyb3IgaW4gcHJvbWlzZVwiKTtcbiAgICBcdCAgfVxuICAgIFx0XG4gICAgfSk7XG4gICAgcmV0dXJuIGZmbXBlZ1Byb21pc2UudGhlbihmdW5jdGlvbihzdWNjZXNzTWVzc2FnZSl7XG4gICAgXHRcdGNvbnNvbGUubG9nKHN1Y2Nlc3NNZXNzYWdlKTtcbiAgICBcdFx0ZG9uZSgpO1xuICAgIFx0XHRcbiAgICB9KTtcbn0pO1xuXG5hcHAuZ2V0KCcvJywgIChyZXEsIHJlcykgPT4ge1xuICAgICByZXR1cm4gcmVzLnJlbmRlcignbGFuZGluZycpO1xufSk7XG5cbmFwcC5nZXQoJy9wcm9iZScsIChyZXEscmVzKSA9Pntcblx0bGV0IHVybCA9IHJlcS5xdWVyeS51cmw7XG5cdGNvbnNvbGUubG9nKFwidGVzdHVybD1cIit1cmwpO1xuXHR2YXIgcHJvYmVKc29uID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gIFx0ICAgICAgXG4gIFx0ICAgIHRyeXsgIFxuICBcdCAgICAgIGZmcHJvYmUodXJsLCBmdW5jdGlvbihyZXN1bHQpIHsgXG4gICAgXHRcdFx0Ly9jcmVhdGUgY29tYmluZWQgSlNPTiBmaWxlXG4gICAgXHRcdFx0dmFyIHJlc3VsdEpzb24gPSByZXN1bHQ7XG4gICAgXHRcdFx0XG4gICAgXHRcdFx0cmVzb2x2ZShyZXN1bHRKc29uKTtcbiAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBcbiAgICAgICAgICBjYXRjaChFeGNlcHRpb24pe1xuICAgICAgICAgIFx0cmVqZWN0KFwiZXJyb3IgaW4gZmZwcm9iZSBwcm9taXNlXCIpO1xuICAgICAgICAgIH1cbiAgICB9KTtcbiAgICBwcm9iZUpzb24udGhlbihmdW5jdGlvbih2YWx1ZSkge1xuLy8gICAgIGNvbnNvbGUubG9nKFwidG90YWwganNvbiBwcm9taXNlOlwiKyB0b3RhbEpzb24pO1xuICAgICAvL2NvbXBhcmUgdGhlIDIgdmlkZW9zXG4gICAgIC8vbm8gbG9uZ2VyIGhhdmUgdG8gYmUgdGhlIHNhbWUgc2l6ZSEhIVxuICAgICAgIHZhciBwYXJzZWRwcm9iZUpzb24gPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICBjb25zb2xlLmxvZyhcInBhcnNlZCBqc29uXCIgKyB2YWx1ZSk7XG4gICAgICAgLy9jb25zdCByZXNwb25zZSA9IHtwYXJzZWRwcm9iZUpzb259O1xuICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZChwYXJzZWRwcm9iZUpzb24pO1xuICAgfSk7XG4gICAgICAgXG59KTtcbiBcblxuYXBwLmdldCgnL3Rlc3QnLCAocmVxLCByZXMpID0+IHtcbiAgICAvL2dldCB1cmxzXG4gICAgLy9pIGV4ZWN0IDIgcGFyYW1zIHJlZmVyZW5jZSB1cmwgcmVmLCB0ZXN0IHVybCB0ZXN0XG4gICAgbGV0IHJlZiA9IHJlcS5xdWVyeS5yZWZ1cmw7XG4gICAgbGV0IHRlc3QgPSByZXEucXVlcnkudGVzdHVybDtcbiAgICBsZXQgYXBpID1mYWxzZTtcbiAgICBcbiAgICBpZiAocmVxLnF1ZXJ5LmFwaSA9PSBcImZhbHNlXCIgKXtcbiAgICAgICBhcGkgPSBmYWxzZTtcbiAgICB9ZWxzZSBpZiAocmVxLnF1ZXJ5LmFwaSA9PSBcInRydWVcIiApe1xuICAgICBcdGFwaSA9IHRydWU7XG4gICAgfVxuICAgIGxldCB0ZXN0UHJpb3JpdHkgPSA1O1xuICAgIGlmIChyZXEucXVlcnkucHJpICE9PSB7fSl7XG4gICAgICB0ZXN0UHJpb3JpdHkgPSByZXEucXVlcnkucHJpO1xuICAgIH1cblxuICAgIC8vY29uc29sZS5sb2coXCJhcGk6IFwiICthcGkpO1xuICAgIC8vY3JlYXRlIHVuaXF1ZSBJRFxuICAgIGNvbnN0IGlkID0gdXVpZHY0KCk7XG4gICAgXG4gICAgLy9nZXQgZmZwcm9iZSBmb3JtYXQgZGF0YSBvZiBib3RoIGZpbGVzLCBhbmQgdGhlbiBydW4gdGhlIHZtYWYgY29tcGFyaXNvbiBcbiAgICB2YXIgdG90YWxKc29uID0gXCJcIjtcbiAgICB2YXIganNvbkNvbWJpbmVkUHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICBcdCAgICAgIFxuICBcdCAgICB0cnl7ICBcbiAgXHQgICAgICBmZnByb2JlKHJlZiwgZnVuY3Rpb24ocmVmcmVzdWx0KSB7IFxuICAgIFx0XHRmZnByb2JlKHRlc3QsIGZ1bmN0aW9uKHRlc3RyZXN1bHQpIHtcbiAgICBcdFx0XHQvL2NyZWF0ZSBjb21iaW5lZCBKU09OIGZpbGVcbiAgICBcdFx0XHR2YXIgY29tYmluZWRKc29uID0gXCJ7XFxcInRlc3RcXFwiOlwiKyB0ZXN0cmVzdWx0K1wiLFxcXCJyZWZlcmVuY2VcXFwiOlwiK3JlZnJlc3VsdCtcIn1cIlxuICAgIFx0XHRcdHJlc29sdmUoY29tYmluZWRKc29uKTtcbiAgICBcdFx0fSk7XG4gICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gXG4gICAgICAgICAgY2F0Y2goRXhjZXB0aW9uKXtcbiAgICAgICAgICBcdHJlamVjdChcImVycm9yIGluIGZmcHJvYmUgcHJvbWlzZVwiKTtcbiAgICAgICAgICB9ICAgXG59KTtcblxuXG5cbmpzb25Db21iaW5lZFByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICB0b3RhbEpzb24gPSB2YWx1ZTtcbi8vICBjb25zb2xlLmxvZyhcInRvdGFsIGpzb24gcHJvbWlzZTpcIisgdG90YWxKc29uKTtcbiAgIC8vY29tcGFyZSB0aGUgMiB2aWRlb3NcbiAgIC8vbm8gbG9uZ2VyIGhhdmUgdG8gYmUgdGhlIHNhbWUgc2l6ZSEhIVxuICAgcGFyc2VkVG90YWxKc29uID0gSlNPTi5wYXJzZSh0b3RhbEpzb24pO1xuICAgY29uc29sZS5sb2cocGFyc2VkVG90YWxKc29uKTtcbiAgIHZhciBzdHJlYW1Db3VudCA9IHBhcnNlZFRvdGFsSnNvblsncmVmZXJlbmNlJ11bJ3N0cmVhbXMnXS5sZW5ndGg7XG4gICB2YXIgcmVmV2lkdGg9MDtcbiAgIHZhciByZWZIZWlnaHQgPSAwO1xuICAgdmFyIHRlc3RXaWR0aD0wO1xuICAgdmFyIHRlc3RIZWlnaHQgPSAwO1xuICAgZm9yKHZhciBpPTA7aTxzdHJlYW1Db3VudDtpKyspe1xuICAgXHRcdGlmIChwYXJzZWRUb3RhbEpzb25bJ3JlZmVyZW5jZSddWydzdHJlYW1zJ11baV1bJ2NvZGVjX3R5cGUnXSA9PVwidmlkZW9cIil7XG4gICBcdFx0ICAgcmVmV2lkdGggPSBwYXJzZWRUb3RhbEpzb25bJ3JlZmVyZW5jZSddWydzdHJlYW1zJ11baV1bJ3dpZHRoJ107XG4gICBcdFx0XHRyZWZIZWlnaHQgPXBhcnNlZFRvdGFsSnNvblsncmVmZXJlbmNlJ11bJ3N0cmVhbXMnXVtpXVsnaGVpZ2h0J107XG4gICBcdFx0XHRjb25zb2xlLmxvZyhcInJlZjogXCIrcmVmSGVpZ2h0ICsgXCIgeFwiICtyZWZXaWR0aCk7XG4gICBcdFx0fVxuICAgXHRcdGlmIChwYXJzZWRUb3RhbEpzb25bJ3Rlc3QnXVsnc3RyZWFtcyddW2ldWydjb2RlY190eXBlJ10gPT1cInZpZGVvXCIpe1xuICAgXHRcdCAgIHRlc3RXaWR0aCA9IHBhcnNlZFRvdGFsSnNvblsndGVzdCddWydzdHJlYW1zJ11baV1bJ3dpZHRoJ107XG4gICBcdFx0XHR0ZXN0SGVpZ2h0ID1wYXJzZWRUb3RhbEpzb25bJ3Rlc3QnXVsnc3RyZWFtcyddW2ldWydoZWlnaHQnXTtcbiAgIFx0XHRcdGNvbnNvbGUubG9nKFwidGVzdDogXCIrdGVzdEhlaWdodCArIFwiIHhcIiArdGVzdFdpZHRoKTtcbiAgIFx0XHR9XG4gICBcbiAgIH0gXG4gICBcbiAgIC8vY29uc29sZS5sb2coJ3JlZiB2aWRlbyBpcyAoaHh3KTonK3JlZkhlaWdodCtyZWZXaWR0aCk7XG4gICAvL2FkZCB2aWRlbyB0byB0aGUgcXVldWUgZm9yIHF1YWxpdHkgc2NvcmluZ1xuICBcbiAgIGNvbnN0IGpvYiA9IHZpZGVvUXVhbGl0eVF1ZXVlLmFkZCh7XG4gICAgIGZpbGVJRDogaWQsXG4gICAgIHRlc3RVcmw6IHRlc3QsIFxuICAgICByZWZVcmw6IHJlZixcbiAgICAgcmVmVmlkZW9IZWlnaHQ6IHJlZkhlaWdodCxcbiAgICAgcmVmVmlkZW9XaWR0aDogcmVmV2lkdGhcbiAgIH0se3ByaW9yaXR5OiB0ZXN0UHJpb3JpdHl9KTtcbiAgIFxuXG4gICAgdG90YWxKc29uID0gSlNPTi5wYXJzZSh0b3RhbEpzb24pO1xuICAgIHZhciBzdGF0dXNDb2RlID0gMTAwO1xuICAgIGlmIChhcGk9PT10cnVlKXtcblxuICAgIFx0Y29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICBcdFx0aWQsIHN0YXR1c0NvZGUsIHJlZkhlaWdodCwgcmVmV2lkdGgsdGVzdFdpZHRoLCB0ZXN0SGVpZ2h0LCB0b3RhbEpzb25cbiAgICBcdH07XG4gICAgXHQvL3NlbmQgYSAxMDAgbWVhbmluZyB0aGF0IHRoZSB0ZXN0IGlzIGluIHByb2Nlc3NcbiAgIFx0XHRyZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQocmVzcG9uc2UpO1xuICAgXHR9IGVsc2V7XG4gICBcdFx0IC8vYnVpbGQgYSBwYWdlIFx0XHQgXG4gICBcdFx0IHJldHVybiByZXMucmVuZGVyKCdpbmRleCcsIHtcbiAgXHRcdFx0aWQsIHN0YXR1c0NvZGUsIHJlZkhlaWdodCwgcmVmV2lkdGgsdGVzdFdpZHRoLCB0ZXN0SGVpZ2h0LCB0b3RhbEpzb25cblx0XHQgfSk7XG4gICBcdFx0IFxuICAgXHRcdCB9XG4gIFxufSk7XG4gXG4gIFxuXG5cbn0pO1xuXG5hcHAuZ2V0KCcvdGVzdFJlc3VsdHMnLCAocmVxLCByZXMpID0+IHtcbiAgLy9pIGV4cGVjdCB0byBnZXQgdGhlIHV1aWQgdGhhdCBjb3JyZXNwb25kcyB0byBhZmlsZW5hbWVcbiAgbGV0IGlkID0gcmVxLnF1ZXJ5LmlkO1xuICAgICAgbGV0IGFwaSA9ZmFsc2U7XG4gICAgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJmYWxzZVwiICl7XG4gICAgICAgYXBpID0gZmFsc2U7XG4gICAgfWVsc2UgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJ0cnVlXCIgKXtcbiAgICAgXHRhcGkgPSB0cnVlO1xuICAgIH1cbiAgLy9nZXQgdGhlIGRhdGEgdGhhdCBpcyBzdG9yZWQgb24gdGhlIHNlcnZlclxuICAvL3F1YWxpdHkgZGF0YVxuICBsZXQgZmlsZW5hbWUgPSBcInRlc3RfXCIgK2lkKyBcIi5qc29uXCI7XG4gIHZhciByZXN1bHQ7XG4gIHRyeSB7XG4gIHJlc3VsdCA9IGZzLnJlYWRGaWxlU3luYyhwYXRoICtmaWxlbmFtZSwgJ3V0ZjgnKTtcbn0gY2F0Y2ggKGVycikge1xuICAgICAvLyBubyBmaWxlIGZvdW5kIC0gbm90IHJlYWR5IHlldFxuICAgICB2YXIgaW5Qcm9ncmVzcyA9IEpTT04ucGFyc2UoXCJ7XFxcInN0YXR1c0NvZGVcXFwiOiAxMDEsIFxcXCJzdGF0dXNcXFwiOiBcXFwiU3RpbGwgcHJvY2Vzc2luZy4gVHJ5IEFnYWluIGluIGEgZmV3IG1pbnV0ZXMuXFxcIn1cIik7XG4gICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZChpblByb2dyZXNzKTtcbn1cblxuICB2YXIganNvbiA9IEpTT04ucGFyc2UocmVzdWx0KTtcbiAgdmFyIHZpZGVvanNvbiA9IEpTT04uc3RyaW5naWZ5KHBhcnNlZFRvdGFsSnNvbik7XG4gLy8gY29uc29sZS5sb2codmlkZW9qc29uKTtcbiAgdmFyIHN0YXR1c0NvZGUgPSAyMDA7XG4gIHZhciBWTUFGID0ganNvblsnVk1BRiBzY29yZSddO1xuICB2YXIgUFNOUiA9IGpzb25bJ1BTTlIgc2NvcmUnXTtcbiAgdmFyIFNTSU0gPSBqc29uWydTU0lNIHNjb3JlJ107XG4gIHZhciByZXR1cm5Kc29uID0gXCJ7XFxcIlZNQUZcXFwiOlwiK2pzb25bJ1ZNQUYgc2NvcmUnXStcIiwgXFxcIlBTTlJcXFwiOlwiK2pzb25bJ1BTTlIgc2NvcmUnXStcIiwgXFxcIlNTSU1cXFwiOlwiK2pzb25bJ1NTSU0gc2NvcmUnXStcIn1cIjtcbiAgcmV0dXJuSnNvbiA9IEpTT04ucGFyc2UocmV0dXJuSnNvbik7XG4gIC8vY29uc29sZS5sb2cocmV0dXJuSnNvbik7XG4gIHZhciBzdGF0dXNDb2RlID0gMjAwO1xuICBpZihhcGkpe1xuICAgIGNvbnN0IHJlc3BvbnNlID0ge1xuICAgICAgaWQsIHN0YXR1c0NvZGUsVk1BRixQU05SLFNTSU1cbiAgICAgfTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQocmVzcG9uc2UpO1xuICB9ZWxzZXtcbiAgICAgLy9idWlsZCBhIHBhZ2UgXHRcdCBcbiAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ3Jlc3VsdHMnLCB7XG4gIFx0XHRcdGlkLCBzdGF0dXNDb2RlLFZNQUYsUFNOUixTU0lNXG5cdCB9KTtcbiAgIFx0XHQgXG4gIH1cbiAgXG59KTtcblxuXG5hcHAubGlzdGVuKDE0MzcsICgpID0+XG4gIGNvbnNvbGUubG9nKGBSZWFkeSB0byBwcm9jZXNzIHZpZGVvIGZpbGVzIG9uIHBvcnQgMTQzNyFgKSxcbik7XG5cblxuZnVuY3Rpb24gZmZwcm9iZSh2aWRlb1VybCwgY2FsbGJhY2spe1xuXHR2YXIgZGF0YVN0cmluZyA9IFwiXCI7XG5cdGxldCBwcm9iZSA9IHNwYXduKCdmZnByb2JlJywgWyctaScsIHZpZGVvVXJsLCAnLXNob3dfZm9ybWF0JywnLXNob3dfc3RyZWFtcycsIGAtdmAsICdxdWlldCcsICctcHJpbnRfZm9ybWF0JywgJ2pzb24nXSk7XG4gICAgLy8gY29uc29sZS5sb2coXCJmZnByb2JlXCIgKyB2aWRlb1VybCk7XG4gICAgIHByb2JlLnN0ZG91dC5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgLy8gY29uc29sZS5sb2coXCJkZWJ1Z2dpbmcgRExcIiArZGF0YS5sZW5ndGgpOyAgICAgXHRcbiAgICAgICAgZGF0YVN0cmluZyArPSBkYXRhLnRvU3RyaW5nKCk7XG5cdFx0Y29uc29sZS5sb2coZGF0YVN0cmluZyk7XG4gXHR9KTtcbiBcdHByb2JlLm9uKCdjbG9zZScsIGZ1bmN0aW9uKGNvZGUpIHtcbiBcdFx0Ly9jb25zb2xlLmxvZyhcImNsb3NlOiBcIisgZGF0YVN0cmluZyk7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhkYXRhU3RyaW5nKTtcbiAgICB9KTtcblxufVxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "pug",
        "require",
        "Queue",
        "favicon",
        "app",
        "use",
        "express",
        "json",
        "urlencoded",
        "extended",
        "set",
        "fs",
        "path",
        "parsedTotalJson",
        "test",
        "spawn",
        "videoQualityQueue",
        "limiter",
        "max",
        "duration",
        "concurrency",
        "process",
        "job",
        "done",
        "jobString",
        "JSON",
        "stringify",
        "file",
        "data",
        "fileID",
        "console",
        "log",
        "ffmpegPromise",
        "Promise",
        "resolve",
        "reject",
        "ffmpeg",
        "testUrl",
        "refUrl",
        "refVideoWidth",
        "refVideoHeight",
        "stderr",
        "on",
        "err",
        "String",
        "stdout",
        "Exception",
        "then",
        "successMessage",
        "get",
        "req",
        "res",
        "render",
        "url",
        "query",
        "probeJson",
        "ffprobe",
        "result",
        "resultJson",
        "value",
        "parsedprobeJson",
        "parse",
        "status",
        "send",
        "ref",
        "refurl",
        "testurl",
        "api",
        "testPriority",
        "pri",
        "id",
        "totalJson",
        "jsonCombinedPromise",
        "refresult",
        "testresult",
        "combinedJson",
        "streamCount",
        "length",
        "refWidth",
        "refHeight",
        "testWidth",
        "testHeight",
        "i",
        "add",
        "priority",
        "statusCode",
        "response",
        "filename",
        "readFileSync",
        "inProgress",
        "videojson",
        "VMAF",
        "PSNR",
        "SSIM",
        "returnJson",
        "listen",
        "videoUrl",
        "callback",
        "dataString",
        "probe",
        "toString",
        "code"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/Doug/Documents/Github/VideoQuality/vmafscan/src",
      "sourcesContent": [
        "//https://www.robinwieruch.de/minimal-node-js-babel-setup\n//great node tutorial\n\nimport 'dotenv/config';\nimport cors from 'cors';\nimport express from 'express';\nimport uuidv4 from 'uuid/v4';\n\nconst pug = require('pug');\n//bull for queuing the vmaf ffmpeg jons\nvar Queue = require('bull');\nvar favicon = require('serve-favicon');\nconst app = express();\napp.use(favicon('public/icon.ico')); \napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\napp.set('view engine','pug');\napp.use(express.static('public/'));\n\n\n//read files\nvar fs = require('fs');\n//var http = require('http');\n//var https = require('https');\n\nvar path = \"../tests/\"\nvar parsedTotalJson=\"\";\nlet test= {};\nconst spawn = require('child_process').spawn;\n\n//create the video queue\n//queue allows 2 jobs at a time\nconst videoQualityQueue = new Queue('ffmpeg-processing-qualityMetrics', {\n  limiter: {\n    max: 1, \n    duration: 1000\n  }\n});\n\nconst concurrency = 1;\nvideoQualityQueue.process(concurrency, function(job, done) {\n    var jobString = JSON.stringify(job);\n    var file = \"test_\" +job.data.fileID+ \".json\";\n    console.log(path+file);\n    var ffmpegPromise = new Promise(function(resolve, reject) {\n         try {\n    \t\tlet ffmpeg = spawn('ffmpeg', ['-i', job.data.testUrl, '-i', job.data.refUrl, '-filter_complex', '[0:v]scale='+job.data.refVideoWidth+'x'+job.data.refVideoHeight+':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:phone_model=true:log_fmt=json:log_path='+path+file, `-f`, 'null', '-']);\n    \t\tconsole.log(\"running test id:\" +job.data.fileID); \n    \t\tffmpeg.stderr.on('data', (err) => {\n            \tconsole.log('err:', new String(err));\n            \t\n    \t\t});\n    \t\tffmpeg.stdout.on('data', function(){ \n    \t\t\t\tconsole.log('stdout');\n    \t\t\t\tresolve(\"success!\");\n    \t\t\t\t\n    \t\t }); \n    \t  }\n    \t  catch (Exception){ \n    \t\t\treject(\"error in promise\");\n    \t  }\n    \t\n    });\n    return ffmpegPromise.then(function(successMessage){\n    \t\tconsole.log(successMessage);\n    \t\tdone();\n    \t\t\n    });\n});\n\napp.get('/',  (req, res) => {\n     return res.render('landing');\n});\n\napp.get('/probe', (req,res) =>{\n\tlet url = req.query.url;\n\tconsole.log(\"testurl=\"+url);\n\tvar probeJson = new Promise(function(resolve, reject) {\n  \t      \n  \t    try{  \n  \t      ffprobe(url, function(result) { \n    \t\t\t//create combined JSON file\n    \t\t\tvar resultJson = result;\n    \t\t\t\n    \t\t\tresolve(resultJson);\n           });\n          } \n          catch(Exception){\n          \treject(\"error in ffprobe promise\");\n          }\n    });\n    probeJson.then(function(value) {\n//     console.log(\"total json promise:\"+ totalJson);\n     //compare the 2 videos\n     //no longer have to be the same size!!!\n       var parsedprobeJson = JSON.parse(value);\n       console.log(\"parsed json\" + value);\n       //const response = {parsedprobeJson};\n       return res.status(200).send(parsedprobeJson);\n   });\n       \n});\n \n\napp.get('/test', (req, res) => {\n    //get urls\n    //i exect 2 params reference url ref, test url test\n    let ref = req.query.refurl;\n    let test = req.query.testurl;\n    let api =false;\n    \n    if (req.query.api == \"false\" ){\n       api = false;\n    }else if (req.query.api == \"true\" ){\n     \tapi = true;\n    }\n    let testPriority = 5;\n    if (req.query.pri !== {}){\n      testPriority = req.query.pri;\n    }\n\n    //console.log(\"api: \" +api);\n    //create unique ID\n    const id = uuidv4();\n    \n    //get ffprobe format data of both files, and then run the vmaf comparison \n    var totalJson = \"\";\n    var jsonCombinedPromise = new Promise(function(resolve, reject) {\n  \t      \n  \t    try{  \n  \t      ffprobe(ref, function(refresult) { \n    \t\tffprobe(test, function(testresult) {\n    \t\t\t//create combined JSON file\n    \t\t\tvar combinedJson = \"{\\\"test\\\":\"+ testresult+\",\\\"reference\\\":\"+refresult+\"}\"\n    \t\t\tresolve(combinedJson);\n    \t\t});\n           });\n          } \n          catch(Exception){\n          \treject(\"error in ffprobe promise\");\n          }   \n});\n\n\n\njsonCombinedPromise.then(function(value) {\n  totalJson = value;\n//  console.log(\"total json promise:\"+ totalJson);\n   //compare the 2 videos\n   //no longer have to be the same size!!!\n   parsedTotalJson = JSON.parse(totalJson);\n   console.log(parsedTotalJson);\n   var streamCount = parsedTotalJson['reference']['streams'].length;\n   var refWidth=0;\n   var refHeight = 0;\n   var testWidth=0;\n   var testHeight = 0;\n   for(var i=0;i<streamCount;i++){\n   \t\tif (parsedTotalJson['reference']['streams'][i]['codec_type'] ==\"video\"){\n   \t\t   refWidth = parsedTotalJson['reference']['streams'][i]['width'];\n   \t\t\trefHeight =parsedTotalJson['reference']['streams'][i]['height'];\n   \t\t\tconsole.log(\"ref: \"+refHeight + \" x\" +refWidth);\n   \t\t}\n   \t\tif (parsedTotalJson['test']['streams'][i]['codec_type'] ==\"video\"){\n   \t\t   testWidth = parsedTotalJson['test']['streams'][i]['width'];\n   \t\t\ttestHeight =parsedTotalJson['test']['streams'][i]['height'];\n   \t\t\tconsole.log(\"test: \"+testHeight + \" x\" +testWidth);\n   \t\t}\n   \n   } \n   \n   //console.log('ref video is (hxw):'+refHeight+refWidth);\n   //add video to the queue for quality scoring\n  \n   const job = videoQualityQueue.add({\n     fileID: id,\n     testUrl: test, \n     refUrl: ref,\n     refVideoHeight: refHeight,\n     refVideoWidth: refWidth\n   },{priority: testPriority});\n   \n\n    totalJson = JSON.parse(totalJson);\n    var statusCode = 100;\n    if (api===true){\n\n    \tconst response = {\n      \t\tid, statusCode, refHeight, refWidth,testWidth, testHeight, totalJson\n    \t};\n    \t//send a 100 meaning that the test is in process\n   \t\treturn res.status(200).send(response);\n   \t} else{\n   \t\t //build a page \t\t \n   \t\t return res.render('index', {\n  \t\t\tid, statusCode, refHeight, refWidth,testWidth, testHeight, totalJson\n\t\t });\n   \t\t \n   \t\t }\n  \n});\n \n  \n\n\n});\n\napp.get('/testResults', (req, res) => {\n  //i expect to get the uuid that corresponds to afilename\n  let id = req.query.id;\n      let api =false;\n    if (req.query.api == \"false\" ){\n       api = false;\n    }else if (req.query.api == \"true\" ){\n     \tapi = true;\n    }\n  //get the data that is stored on the server\n  //quality data\n  let filename = \"test_\" +id+ \".json\";\n  var result;\n  try {\n  result = fs.readFileSync(path +filename, 'utf8');\n} catch (err) {\n     // no file found - not ready yet\n     var inProgress = JSON.parse(\"{\\\"statusCode\\\": 101, \\\"status\\\": \\\"Still processing. Try Again in a few minutes.\\\"}\");\n     return res.status(200).send(inProgress);\n}\n\n  var json = JSON.parse(result);\n  var videojson = JSON.stringify(parsedTotalJson);\n // console.log(videojson);\n  var statusCode = 200;\n  var VMAF = json['VMAF score'];\n  var PSNR = json['PSNR score'];\n  var SSIM = json['SSIM score'];\n  var returnJson = \"{\\\"VMAF\\\":\"+json['VMAF score']+\", \\\"PSNR\\\":\"+json['PSNR score']+\", \\\"SSIM\\\":\"+json['SSIM score']+\"}\";\n  returnJson = JSON.parse(returnJson);\n  //console.log(returnJson);\n  var statusCode = 200;\n  if(api){\n    const response = {\n      id, statusCode,VMAF,PSNR,SSIM\n     };\n    return res.status(200).send(response);\n  }else{\n     //build a page \t\t \n     return res.render('results', {\n  \t\t\tid, statusCode,VMAF,PSNR,SSIM\n\t });\n   \t\t \n  }\n  \n});\n\n\napp.listen(1437, () =>\n  console.log(`Ready to process video files on port 1437!`),\n);\n\n\nfunction ffprobe(videoUrl, callback){\n\tvar dataString = \"\";\n\tlet probe = spawn('ffprobe', ['-i', videoUrl, '-show_format','-show_streams', `-v`, 'quiet', '-print_format', 'json']);\n    // console.log(\"ffprobe\" + videoUrl);\n     probe.stdout.on('data', (data) => {\n       // console.log(\"debugging DL\" +data.length);     \t\n        dataString += data.toString();\n\t\tconsole.log(dataString);\n \t});\n \tprobe.on('close', function(code) {\n \t\t//console.log(\"close: \"+ dataString);\n        return callback(dataString);\n    });\n\n}\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1574149530301
  },
  "{\"sourceRoot\":\"/Users/dougsillars/Documents/Github/StreamClarity/vmafscan/src\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/dougsillars/Documents/Github/StreamClarity/vmafscan\",\"filename\":\"/Users/dougsillars/Documents/Github/StreamClarity/vmafscan/src/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/dougsillars/Documents/Github/StreamClarity/vmafscan\",\"plugins\":[],\"presets\":[]}:7.5.5": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/dougsillars/Documents/Github/StreamClarity/vmafscan/src",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/dougsillars/Documents/Github/StreamClarity/vmafscan",
      "filename": "/Users/dougsillars/Documents/Github/StreamClarity/vmafscan/src/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/dougsillars/Documents/Github/StreamClarity/vmafscan",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/dougsillars/Documents/Github/StreamClarity/vmafscan/src/index.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "/Users/dougsillars/Documents/Github/StreamClarity/vmafscan/src/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/dougsillars/Documents/Github/StreamClarity/vmafscan/src",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "//https://www.robinwieruch.de/minimal-node-js-babel-setup\n//great node tutorial\nrequire('dotenv/config');\n\nconst cors = require('cors');\n\nconst express = require('express');\n\nconst uuidv4 = require('uuid/v4'); //import cors from 'cors';\n//import express from 'express';\n//import uuidv4 from 'uuid/v4';\n\n\nconst pug = require('pug'); //bull for queuing the vmaf ffmpeg jons\n\n\nvar Queue = require('bull');\n\nvar favicon = require('serve-favicon');\n\nconst app = express();\napp.use(favicon('public/icon.ico'));\napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({\n  extended: true\n}));\napp.set('view engine', 'pug');\napp.use(express.static('public/')); //moesif\n\nvar moesif = require('moesif-express'); // 2. Set the options, the only required field is applicationId\n\n\nvar moesifMiddleware = moesif({\n  applicationId: 'eyJhcHAiOiI1MTk6MTQ3IiwidmVyIjoiMi4wIiwib3JnIjoiMjQwOjIxMCIsImlhdCI6MTU5Mjg3MDQwMH0.rcYbuEeoN8kSUiopSYFy6ZAhThA0ZGaJLsavzWqaOoQ',\n  // Set to false if you don't want to capture req/resp body\n  logBody: true,\n  // Optional hook to link API calls to users\n  identifyUser: function (req, res) {\n    return req.user ? req.user.id : undefined;\n  }\n}); // 3. Enable the Moesif middleware to start capturing incoming API Calls\n\napp.use(moesifMiddleware); //read files\n\nvar fs = require('fs'); //var http = require('http');\n//var https = require('https');\n\n\nvar path = \"../tests/\";\nvar parsedTotalJson = \"\";\nlet test = {};\n\nconst spawn = require('child_process').spawn; //create the video queue\n//queue allows 2 jobs at a time\n\n\nconst videoQualityQueue = new Queue('ffmpeg-processing-qualityMetrics', {\n  limiter: {\n    max: 1,\n    duration: 1000\n  }\n});\nconst concurrency = 1;\nvideoQualityQueue.process(concurrency, function (job, done) {\n  var jobString = JSON.stringify(job);\n  var file = \"test_\" + job.data.fileID + \".json\";\n  console.log(path + file);\n  console.log(\"mobile?\" + job.data.mobile);\n  var ffmpegPromise = new Promise(function (resolve, reject) {\n    var params = ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:phone_model=true:log_fmt=json:log_path=';\n\n    if (!job.data.mobile) {\n      params = ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:log_fmt=json:log_path=';\n    }\n\n    console.log(\"mobile: \" + job.data.mobile);\n    console.log(\"params: \" + params);\n\n    try {\n      let ffmpeg = spawn('ffmpeg', ['-i', job.data.testUrl, '-i', job.data.refUrl, '-filter_complex', '[0:v]scale=' + job.data.refVideoWidth + 'x' + job.data.refVideoHeight + params + path + file, `-f`, 'null', '-']);\n      console.log(\"running test id:\" + job.data.fileID);\n      ffmpeg.stderr.on('data', err => {\n        console.log('err:', new String(err));\n      });\n      ffmpeg.stdout.on('data', function () {\n        console.log('stdout');\n        resolve(\"success!\");\n      });\n    } catch (Exception) {\n      reject(\"error in promise\");\n    }\n  });\n  return ffmpegPromise.then(function (successMessage) {\n    console.log(successMessage);\n    done();\n  });\n});\napp.get('/', (req, res) => {\n  return res.render('landing');\n});\napp.get('/probe', (req, res) => {\n  let url = req.query.url;\n  console.log(\"testurl=\" + url);\n  var probeJson = new Promise(function (resolve, reject) {\n    try {\n      ffprobe(url, function (result) {\n        //create combined JSON file\n        var resultJson = result;\n        resolve(resultJson);\n      });\n    } catch (Exception) {\n      reject(\"error in ffprobe promise\");\n    }\n  });\n  probeJson.then(function (value) {\n    //     console.log(\"total json promise:\"+ totalJson);\n    //compare the 2 videos\n    //no longer have to be the same size!!!\n    var parsedprobeJson = JSON.parse(value);\n    console.log(\"parsed json\" + value); //const response = {parsedprobeJson};\n\n    return res.status(200).send(parsedprobeJson);\n  });\n});\napp.get('/test', (req, res) => {\n  //get urls\n  //i exect 2 params reference url ref, test url test\n  //i expect 3 parameters reference url ref, test url test, and mobile model\n  let ref = req.query.refurl;\n  let test = req.query.testurl;\n  let api = false;\n  let mobile = true;\n\n  if (req.query.api == \"false\") {\n    api = false;\n  } else if (req.query.api == \"true\") {\n    api = true;\n  }\n\n  if (req.query.mobilemodel == \"on\") {\n    mobile = true;\n  } else {\n    mobile = false;\n  }\n\n  let testPriority = 5;\n\n  if (req.query.pri !== {}) {\n    testPriority = req.query.pri;\n  } //console.log(\"api: \" +api);\n  //create unique ID\n\n\n  const id = uuidv4(); //get ffprobe format data of both files, and then run the vmaf comparison \n\n  var totalJson = \"\";\n  var jsonCombinedPromise = new Promise(function (resolve, reject) {\n    try {\n      ffprobe(ref, function (refresult) {\n        ffprobe(test, function (testresult) {\n          //create combined JSON file\n          var combinedJson = \"{\\\"test\\\":\" + testresult + \",\\\"reference\\\":\" + refresult + \",\\\"mobile\\\":\" + mobile + \"}\";\n          resolve(combinedJson);\n        });\n      });\n    } catch (Exception) {\n      reject(\"error in ffprobe promise\");\n    }\n  });\n  jsonCombinedPromise.then(function (value) {\n    totalJson = value; //  console.log(\"total json promise:\"+ totalJson);\n    //compare the 2 videos\n    //no longer have to be the same size!!!\n\n    parsedTotalJson = JSON.parse(totalJson);\n    console.log(parsedTotalJson);\n    var streamCount = parsedTotalJson['reference']['streams'].length;\n    var mobile = parsedTotalJson['mobile'];\n    var refWidth = 0;\n    var refHeight = 0;\n    var testWidth = 0;\n    var testHeight = 0;\n\n    for (var i = 0; i < streamCount; i++) {\n      if (parsedTotalJson['reference']['streams'][i]['codec_type'] == \"video\") {\n        refWidth = parsedTotalJson['reference']['streams'][i]['width'];\n        refHeight = parsedTotalJson['reference']['streams'][i]['height'];\n        console.log(\"ref: \" + refHeight + \" x\" + refWidth);\n      }\n\n      if (parsedTotalJson['test']['streams'][i]['codec_type'] == \"video\") {\n        testWidth = parsedTotalJson['test']['streams'][i]['width'];\n        testHeight = parsedTotalJson['test']['streams'][i]['height'];\n        console.log(\"test: \" + testHeight + \" x\" + testWidth);\n      }\n    } //console.log('ref video is (hxw):'+refHeight+refWidth);\n    //add video to the queue for quality scoring\n\n\n    const job = videoQualityQueue.add({\n      fileID: id,\n      testUrl: test,\n      refUrl: ref,\n      mobile: mobile,\n      refVideoHeight: refHeight,\n      refVideoWidth: refWidth\n    }, {\n      priority: testPriority\n    });\n    console.log(\"fileid:\" + id + \"mobile\" + mobile);\n    totalJson = JSON.parse(totalJson);\n    var statusCode = 100;\n\n    if (api === true) {\n      const response = {\n        id,\n        statusCode,\n        refHeight,\n        refWidth,\n        testWidth,\n        testHeight,\n        totalJson,\n        mobile\n      }; //send a 100 meaning that the test is in process\n\n      return res.status(200).send(response);\n    } else {\n      //build a page \t\t \n      return res.render('index', {\n        id,\n        statusCode,\n        refHeight,\n        refWidth,\n        testWidth,\n        testHeight,\n        totalJson,\n        mobile\n      });\n    }\n  });\n});\napp.get('/testResults', (req, res) => {\n  //i expect to get the uuid that corresponds to afilename\n  let id = req.query.id;\n  let api = false;\n\n  if (req.query.api == \"false\") {\n    api = false;\n  } else if (req.query.api == \"true\") {\n    api = true;\n  }\n\n  let mobile = req.query.mobile;\n  console.log(\"mobile model:\" + mobile); //get the data that is stored on the server\n  //quality data\n\n  let filename = \"test_\" + id + \".json\";\n  var result;\n\n  try {\n    result = fs.readFileSync(path + filename, 'utf8');\n  } catch (err) {\n    // no file found - not ready yet\n    var inProgress = JSON.parse(\"{\\\"statusCode\\\": 101, \\\"status\\\": \\\"Still processing. Try Again in a few minutes.\\\"}\");\n    return res.status(200).send(inProgress);\n  }\n\n  var json = JSON.parse(result);\n  var videojson = JSON.stringify(parsedTotalJson);\n  console.log(videojson);\n  var statusCode = 200;\n  var VMAF = json['VMAF score'];\n  var PSNR = json['PSNR score'];\n  var SSIM = json['SSIM score'];\n  var returnJson = \"{\\\"VMAF\\\":\" + json['VMAF score'] + \", \\\"PSNR\\\":\" + json['PSNR score'] + \", \\\"SSIM\\\":\" + json['SSIM score'] + \", \\\"mobile\\\":\" + mobile + \"}\";\n  returnJson = JSON.parse(returnJson); //console.log(returnJson);\n\n  var statusCode = 200;\n\n  if (api) {\n    const response = {\n      id,\n      mobile,\n      statusCode,\n      VMAF,\n      PSNR,\n      SSIM\n    };\n    return res.status(200).send(response);\n  } else {\n    //build a page \t\t \n    return res.render('results', {\n      id,\n      mobile,\n      statusCode,\n      VMAF,\n      PSNR,\n      SSIM\n    });\n  }\n});\napp.listen(1437, () => console.log(`Ready to process video files on port 1437!`));\n\nfunction ffprobe(videoUrl, callback) {\n  var dataString = \"\";\n  let probe = spawn('ffprobe', ['-i', videoUrl, '-show_format', '-show_streams', `-v`, 'quiet', '-print_format', 'json']); // console.log(\"ffprobe\" + videoUrl);\n\n  probe.stdout.on('data', data => {\n    // console.log(\"debugging DL\" +data.length);     \t\n    dataString += data.toString();\n    console.log(dataString);\n  });\n  probe.on('close', function (code) {\n    //console.log(\"close: \"+ dataString);\n    return callback(dataString);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJjb3JzIiwiZXhwcmVzcyIsInV1aWR2NCIsInB1ZyIsIlF1ZXVlIiwiZmF2aWNvbiIsImFwcCIsInVzZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJzZXQiLCJzdGF0aWMiLCJtb2VzaWYiLCJtb2VzaWZNaWRkbGV3YXJlIiwiYXBwbGljYXRpb25JZCIsImxvZ0JvZHkiLCJpZGVudGlmeVVzZXIiLCJyZXEiLCJyZXMiLCJ1c2VyIiwiaWQiLCJ1bmRlZmluZWQiLCJmcyIsInBhdGgiLCJwYXJzZWRUb3RhbEpzb24iLCJ0ZXN0Iiwic3Bhd24iLCJ2aWRlb1F1YWxpdHlRdWV1ZSIsImxpbWl0ZXIiLCJtYXgiLCJkdXJhdGlvbiIsImNvbmN1cnJlbmN5IiwicHJvY2VzcyIsImpvYiIsImRvbmUiLCJqb2JTdHJpbmciLCJKU09OIiwic3RyaW5naWZ5IiwiZmlsZSIsImRhdGEiLCJmaWxlSUQiLCJjb25zb2xlIiwibG9nIiwibW9iaWxlIiwiZmZtcGVnUHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicGFyYW1zIiwiZmZtcGVnIiwidGVzdFVybCIsInJlZlVybCIsInJlZlZpZGVvV2lkdGgiLCJyZWZWaWRlb0hlaWdodCIsInN0ZGVyciIsIm9uIiwiZXJyIiwiU3RyaW5nIiwic3Rkb3V0IiwiRXhjZXB0aW9uIiwidGhlbiIsInN1Y2Nlc3NNZXNzYWdlIiwiZ2V0IiwicmVuZGVyIiwidXJsIiwicXVlcnkiLCJwcm9iZUpzb24iLCJmZnByb2JlIiwicmVzdWx0IiwicmVzdWx0SnNvbiIsInZhbHVlIiwicGFyc2VkcHJvYmVKc29uIiwicGFyc2UiLCJzdGF0dXMiLCJzZW5kIiwicmVmIiwicmVmdXJsIiwidGVzdHVybCIsImFwaSIsIm1vYmlsZW1vZGVsIiwidGVzdFByaW9yaXR5IiwicHJpIiwidG90YWxKc29uIiwianNvbkNvbWJpbmVkUHJvbWlzZSIsInJlZnJlc3VsdCIsInRlc3RyZXN1bHQiLCJjb21iaW5lZEpzb24iLCJzdHJlYW1Db3VudCIsImxlbmd0aCIsInJlZldpZHRoIiwicmVmSGVpZ2h0IiwidGVzdFdpZHRoIiwidGVzdEhlaWdodCIsImkiLCJhZGQiLCJwcmlvcml0eSIsInN0YXR1c0NvZGUiLCJyZXNwb25zZSIsImZpbGVuYW1lIiwicmVhZEZpbGVTeW5jIiwiaW5Qcm9ncmVzcyIsInZpZGVvanNvbiIsIlZNQUYiLCJQU05SIiwiU1NJTSIsInJldHVybkpzb24iLCJsaXN0ZW4iLCJ2aWRlb1VybCIsImNhbGxiYWNrIiwiZGF0YVN0cmluZyIsInByb2JlIiwidG9TdHJpbmciLCJjb2RlIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBR0FBLE9BQU8sQ0FBQyxlQUFELENBQVA7O0FBQ0EsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFDQSxNQUFNRSxPQUFPLEdBQUVGLE9BQU8sQ0FBQyxTQUFELENBQXRCOztBQUNBLE1BQU1HLE1BQU0sR0FBRUgsT0FBTyxDQUFDLFNBQUQsQ0FBckIsQyxDQUVBO0FBQ0E7QUFDQTs7O0FBRUEsTUFBTUksR0FBRyxHQUFHSixPQUFPLENBQUMsS0FBRCxDQUFuQixDLENBQ0E7OztBQUNBLElBQUlLLEtBQUssR0FBR0wsT0FBTyxDQUFDLE1BQUQsQ0FBbkI7O0FBQ0EsSUFBSU0sT0FBTyxHQUFHTixPQUFPLENBQUMsZUFBRCxDQUFyQjs7QUFDQSxNQUFNTyxHQUFHLEdBQUdMLE9BQU8sRUFBbkI7QUFDQUssR0FBRyxDQUFDQyxHQUFKLENBQVFGLE9BQU8sQ0FBQyxpQkFBRCxDQUFmO0FBQ0FDLEdBQUcsQ0FBQ0MsR0FBSixDQUFRUCxJQUFJLEVBQVo7QUFDQU0sR0FBRyxDQUFDQyxHQUFKLENBQVFOLE9BQU8sQ0FBQ08sSUFBUixFQUFSO0FBQ0FGLEdBQUcsQ0FBQ0MsR0FBSixDQUFRTixPQUFPLENBQUNRLFVBQVIsQ0FBbUI7QUFBRUMsRUFBQUEsUUFBUSxFQUFFO0FBQVosQ0FBbkIsQ0FBUjtBQUNB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QUFLSEMsRUFBQUEsS0FBSyxDQUFDdkQsRUFBTixDQUFTLE9BQVQsRUFBa0IsVUFBU3lELElBQVQsRUFBZTtBQUNoQztBQUNLLFdBQU9KLFFBQVEsQ0FBQ0MsVUFBRCxDQUFmO0FBQ0gsR0FISDtBQUtEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9kb3Vnc2lsbGFycy9Eb2N1bWVudHMvR2l0aHViL1N0cmVhbUNsYXJpdHkvdm1hZnNjYW4vc3JjIiwic291cmNlc0NvbnRlbnQiOlsiLy9odHRwczovL3d3dy5yb2JpbndpZXJ1Y2guZGUvbWluaW1hbC1ub2RlLWpzLWJhYmVsLXNldHVwXG4vL2dyZWF0IG5vZGUgdHV0b3JpYWxcblxuXG5yZXF1aXJlKCdkb3RlbnYvY29uZmlnJyk7XG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpO1xuY29uc3QgZXhwcmVzcyA9cmVxdWlyZSgnZXhwcmVzcycpO1xuY29uc3QgdXVpZHY0ID1yZXF1aXJlKCd1dWlkL3Y0Jyk7XG5cbi8vaW1wb3J0IGNvcnMgZnJvbSAnY29ycyc7XG4vL2ltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuLy9pbXBvcnQgdXVpZHY0IGZyb20gJ3V1aWQvdjQnO1xuXG5jb25zdCBwdWcgPSByZXF1aXJlKCdwdWcnKTtcbi8vYnVsbCBmb3IgcXVldWluZyB0aGUgdm1hZiBmZm1wZWcgam9uc1xudmFyIFF1ZXVlID0gcmVxdWlyZSgnYnVsbCcpO1xudmFyIGZhdmljb24gPSByZXF1aXJlKCdzZXJ2ZS1mYXZpY29uJyk7XG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5hcHAudXNlKGZhdmljb24oJ3B1YmxpYy9pY29uLmljbycpKTsgXG5hcHAudXNlKGNvcnMoKSk7XG5hcHAudXNlKGV4cHJlc3MuanNvbigpKTtcbmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpO1xuYXBwLnNldCgndmlldyBlbmdpbmUnLCdwdWcnKTtcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMoJ3B1YmxpYy8nKSk7XG5cbi8vbW9lc2lmXG52YXIgbW9lc2lmID0gcmVxdWlyZSgnbW9lc2lmLWV4cHJlc3MnKTtcbi8vIDIuIFNldCB0aGUgb3B0aW9ucywgdGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgaXMgYXBwbGljYXRpb25JZFxudmFyIG1vZXNpZk1pZGRsZXdhcmUgPSBtb2VzaWYoe1xuICBhcHBsaWNhdGlvbklkOiAnZXlKaGNIQWlPaUkxTVRrNk1UUTNJaXdpZG1WeUlqb2lNaTR3SWl3aWIzSm5Jam9pTWpRd09qSXhNQ0lzSW1saGRDSTZNVFU1TWpnM01EUXdNSDAucmNZYnVFZW9OOGtTVWlvcFNZRnk2WkFoVGhBMFpHYUpMc2F2eldxYU9vUScsXG4gIC8vIFNldCB0byBmYWxzZSBpZiB5b3UgZG9uJ3Qgd2FudCB0byBjYXB0dXJlIHJlcS9yZXNwIGJvZHlcbiAgbG9nQm9keTogdHJ1ZSxcblxuICAvLyBPcHRpb25hbCBob29rIHRvIGxpbmsgQVBJIGNhbGxzIHRvIHVzZXJzXG4gIGlkZW50aWZ5VXNlcjogZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gICAgcmV0dXJuIHJlcS51c2VyID8gcmVxLnVzZXIuaWQgOiB1bmRlZmluZWQ7XG4gIH0sXG59KTtcblxuLy8gMy4gRW5hYmxlIHRoZSBNb2VzaWYgbWlkZGxld2FyZSB0byBzdGFydCBjYXB0dXJpbmcgaW5jb21pbmcgQVBJIENhbGxzXG5hcHAudXNlKG1vZXNpZk1pZGRsZXdhcmUpO1xuXG5cbi8vcmVhZCBmaWxlc1xudmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcbi8vdmFyIGh0dHAgPSByZXF1aXJlKCdodHRwJyk7XG4vL3ZhciBodHRwcyA9IHJlcXVpcmUoJ2h0dHBzJyk7XG5cbnZhciBwYXRoID0gXCIuLi90ZXN0cy9cIlxudmFyIHBhcnNlZFRvdGFsSnNvbj1cIlwiO1xubGV0IHRlc3Q9IHt9O1xuY29uc3Qgc3Bhd24gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuc3Bhd247XG5cbi8vY3JlYXRlIHRoZSB2aWRlbyBxdWV1ZVxuLy9xdWV1ZSBhbGxvd3MgMiBqb2JzIGF0IGEgdGltZVxuY29uc3QgdmlkZW9RdWFsaXR5UXVldWUgPSBuZXcgUXVldWUoJ2ZmbXBlZy1wcm9jZXNzaW5nLXF1YWxpdHlNZXRyaWNzJywge1xuICBsaW1pdGVyOiB7XG4gICAgbWF4OiAxLCBcbiAgICBkdXJhdGlvbjogMTAwMFxuICB9XG59KTtcblxuY29uc3QgY29uY3VycmVuY3kgPSAxO1xudmlkZW9RdWFsaXR5UXVldWUucHJvY2Vzcyhjb25jdXJyZW5jeSwgZnVuY3Rpb24oam9iLCBkb25lKSB7XG4gICAgdmFyIGpvYlN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGpvYik7XG4gICAgdmFyIGZpbGUgPSBcInRlc3RfXCIgK2pvYi5kYXRhLmZpbGVJRCsgXCIuanNvblwiO1xuICAgIGNvbnNvbGUubG9nKHBhdGgrZmlsZSk7XG5cdGNvbnNvbGUubG9nKFwibW9iaWxlP1wiICtqb2IuZGF0YS5tb2JpbGUpO1xuICAgIHZhciBmZm1wZWdQcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIHBhcmFtcyA9ICc6ZmxhZ3M9YmljdWJpY1ttYWluXTtbbWFpbl1bMTp2XWxpYnZtYWY9c3NpbT10cnVlOnBzbnI9dHJ1ZTpwaG9uZV9tb2RlbD10cnVlOmxvZ19mbXQ9anNvbjpsb2dfcGF0aD0nO1xuXHRcdGlmKCFqb2IuZGF0YS5tb2JpbGUpe1xuXHRcdFx0cGFyYW1zID0gJzpmbGFncz1iaWN1YmljW21haW5dO1ttYWluXVsxOnZdbGlidm1hZj1zc2ltPXRydWU6cHNucj10cnVlOmxvZ19mbXQ9anNvbjpsb2dfcGF0aD0nXG5cdFx0fVxuXHRcdGNvbnNvbGUubG9nKFwibW9iaWxlOiBcIiAram9iLmRhdGEubW9iaWxlKTtcblx0XHRjb25zb2xlLmxvZyhcInBhcmFtczogXCIgK3BhcmFtcyk7XG4gICAgICAgICB0cnkge1xuICAgIFx0XHRsZXQgZmZtcGVnID0gc3Bhd24oJ2ZmbXBlZycsIFsnLWknLCBqb2IuZGF0YS50ZXN0VXJsLCAnLWknLCBqb2IuZGF0YS5yZWZVcmwsICctZmlsdGVyX2NvbXBsZXgnLCAnWzA6dl1zY2FsZT0nK2pvYi5kYXRhLnJlZlZpZGVvV2lkdGgrJ3gnK2pvYi5kYXRhLnJlZlZpZGVvSGVpZ2h0K3BhcmFtcytwYXRoK2ZpbGUsIGAtZmAsICdudWxsJywgJy0nXSk7XG4gICAgXHRcdGNvbnNvbGUubG9nKFwicnVubmluZyB0ZXN0IGlkOlwiICtqb2IuZGF0YS5maWxlSUQpOyBcbiAgICBcdFx0ZmZtcGVnLnN0ZGVyci5vbignZGF0YScsIChlcnIpID0+IHtcbiAgICAgICAgICAgIFx0Y29uc29sZS5sb2coJ2VycjonLCBuZXcgU3RyaW5nKGVycikpO1xuICAgICAgICAgICAgXHRcbiAgICBcdFx0fSk7XG4gICAgXHRcdGZmbXBlZy5zdGRvdXQub24oJ2RhdGEnLCBmdW5jdGlvbigpeyBcbiAgICBcdFx0XHRcdGNvbnNvbGUubG9nKCdzdGRvdXQnKTtcbiAgICBcdFx0XHRcdHJlc29sdmUoXCJzdWNjZXNzIVwiKTtcbiAgICBcdFx0XHRcdFxuICAgIFx0XHQgfSk7IFxuICAgIFx0ICB9XG4gICAgXHQgIGNhdGNoIChFeGNlcHRpb24peyBcbiAgICBcdFx0XHRyZWplY3QoXCJlcnJvciBpbiBwcm9taXNlXCIpO1xuICAgIFx0ICB9XG4gICAgXHRcbiAgICB9KTtcbiAgICByZXR1cm4gZmZtcGVnUHJvbWlzZS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3NNZXNzYWdlKXtcbiAgICBcdFx0Y29uc29sZS5sb2coc3VjY2Vzc01lc3NhZ2UpO1xuICAgIFx0XHRkb25lKCk7XG4gICAgXHRcdFxuICAgIH0pO1xufSk7XG5cbmFwcC5nZXQoJy8nLCAgKHJlcSwgcmVzKSA9PiB7XG4gICAgIHJldHVybiByZXMucmVuZGVyKCdsYW5kaW5nJyk7XG59KTtcblxuYXBwLmdldCgnL3Byb2JlJywgKHJlcSxyZXMpID0+e1xuXHRsZXQgdXJsID0gcmVxLnF1ZXJ5LnVybDtcblx0Y29uc29sZS5sb2coXCJ0ZXN0dXJsPVwiK3VybCk7XG5cdHZhciBwcm9iZUpzb24gPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgXHQgICAgICBcbiAgXHQgICAgdHJ5eyAgXG4gIFx0ICAgICAgZmZwcm9iZSh1cmwsIGZ1bmN0aW9uKHJlc3VsdCkgeyBcbiAgICBcdFx0XHQvL2NyZWF0ZSBjb21iaW5lZCBKU09OIGZpbGVcbiAgICBcdFx0XHR2YXIgcmVzdWx0SnNvbiA9IHJlc3VsdDtcbiAgICBcdFx0XHRcbiAgICBcdFx0XHRyZXNvbHZlKHJlc3VsdEpzb24pO1xuICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IFxuICAgICAgICAgIGNhdGNoKEV4Y2VwdGlvbil7XG4gICAgICAgICAgXHRyZWplY3QoXCJlcnJvciBpbiBmZnByb2JlIHByb21pc2VcIik7XG4gICAgICAgICAgfVxuICAgIH0pO1xuICAgIHByb2JlSnNvbi50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4vLyAgICAgY29uc29sZS5sb2coXCJ0b3RhbCBqc29uIHByb21pc2U6XCIrIHRvdGFsSnNvbik7XG4gICAgIC8vY29tcGFyZSB0aGUgMiB2aWRlb3NcbiAgICAgLy9ubyBsb25nZXIgaGF2ZSB0byBiZSB0aGUgc2FtZSBzaXplISEhXG4gICAgICAgdmFyIHBhcnNlZHByb2JlSnNvbiA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgIGNvbnNvbGUubG9nKFwicGFyc2VkIGpzb25cIiArIHZhbHVlKTtcbiAgICAgICAvL2NvbnN0IHJlc3BvbnNlID0ge3BhcnNlZHByb2JlSnNvbn07XG4gICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHBhcnNlZHByb2JlSnNvbik7XG4gICB9KTtcbiAgICAgICBcbn0pO1xuIFxuXG5hcHAuZ2V0KCcvdGVzdCcsIChyZXEsIHJlcykgPT4ge1xuICAgIC8vZ2V0IHVybHNcbiAgICAvL2kgZXhlY3QgMiBwYXJhbXMgcmVmZXJlbmNlIHVybCByZWYsIHRlc3QgdXJsIHRlc3Rcblx0Ly9pIGV4cGVjdCAzIHBhcmFtZXRlcnMgcmVmZXJlbmNlIHVybCByZWYsIHRlc3QgdXJsIHRlc3QsIGFuZCBtb2JpbGUgbW9kZWxcbiAgICBsZXQgcmVmID0gcmVxLnF1ZXJ5LnJlZnVybDtcbiAgICBsZXQgdGVzdCA9IHJlcS5xdWVyeS50ZXN0dXJsO1xuICAgIGxldCBhcGkgPWZhbHNlO1xuXHRsZXQgbW9iaWxlID0gdHJ1ZTtcbiAgICBcblx0XG4gICAgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJmYWxzZVwiICl7XG4gICAgICAgYXBpID0gZmFsc2U7XG4gICAgfWVsc2UgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJ0cnVlXCIgKXtcbiAgICAgXHRhcGkgPSB0cnVlO1xuICAgIH1cbiBcbiAgICBpZiAocmVxLnF1ZXJ5Lm1vYmlsZW1vZGVsID09IFwib25cIiApe1xuICAgICBcdG1vYmlsZSA9IHRydWU7XG4gICAgfWVsc2V7IG1vYmlsZT1mYWxzZTt9XG5cdFxuICAgIGxldCB0ZXN0UHJpb3JpdHkgPSA1O1xuICAgIGlmIChyZXEucXVlcnkucHJpICE9PSB7fSl7XG4gICAgICB0ZXN0UHJpb3JpdHkgPSByZXEucXVlcnkucHJpO1xuICAgIH1cblxuICAgIC8vY29uc29sZS5sb2coXCJhcGk6IFwiICthcGkpO1xuICAgIC8vY3JlYXRlIHVuaXF1ZSBJRFxuICAgIGNvbnN0IGlkID0gdXVpZHY0KCk7XG4gICAgXG4gICAgLy9nZXQgZmZwcm9iZSBmb3JtYXQgZGF0YSBvZiBib3RoIGZpbGVzLCBhbmQgdGhlbiBydW4gdGhlIHZtYWYgY29tcGFyaXNvbiBcbiAgICB2YXIgdG90YWxKc29uID0gXCJcIjtcbiAgICB2YXIganNvbkNvbWJpbmVkUHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICBcdCAgICAgIFxuICBcdCAgICB0cnl7ICBcbiAgXHQgICAgICBmZnByb2JlKHJlZiwgZnVuY3Rpb24ocmVmcmVzdWx0KSB7IFxuICAgIFx0XHRmZnByb2JlKHRlc3QsIGZ1bmN0aW9uKHRlc3RyZXN1bHQpIHtcbiAgICBcdFx0XHQvL2NyZWF0ZSBjb21iaW5lZCBKU09OIGZpbGVcbiAgICBcdFx0XHR2YXIgY29tYmluZWRKc29uID0gXCJ7XFxcInRlc3RcXFwiOlwiKyB0ZXN0cmVzdWx0K1wiLFxcXCJyZWZlcmVuY2VcXFwiOlwiK3JlZnJlc3VsdCtcIixcXFwibW9iaWxlXFxcIjpcIittb2JpbGUrXCJ9XCJcbiAgICBcdFx0XHRyZXNvbHZlKGNvbWJpbmVkSnNvbik7XG4gICAgXHRcdH0pO1xuICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IFxuICAgICAgICAgIGNhdGNoKEV4Y2VwdGlvbil7XG4gICAgICAgICAgXHRyZWplY3QoXCJlcnJvciBpbiBmZnByb2JlIHByb21pc2VcIik7XG4gICAgICAgICAgfSAgIFxufSk7XG5cblxuXG5qc29uQ29tYmluZWRQcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgdG90YWxKc29uID0gdmFsdWU7XG4vLyAgY29uc29sZS5sb2coXCJ0b3RhbCBqc29uIHByb21pc2U6XCIrIHRvdGFsSnNvbik7XG4gICAvL2NvbXBhcmUgdGhlIDIgdmlkZW9zXG4gICAvL25vIGxvbmdlciBoYXZlIHRvIGJlIHRoZSBzYW1lIHNpemUhISFcbiAgIHBhcnNlZFRvdGFsSnNvbiA9IEpTT04ucGFyc2UodG90YWxKc29uKTtcbiAgIGNvbnNvbGUubG9nKHBhcnNlZFRvdGFsSnNvbik7XG4gICB2YXIgc3RyZWFtQ291bnQgPSBwYXJzZWRUb3RhbEpzb25bJ3JlZmVyZW5jZSddWydzdHJlYW1zJ10ubGVuZ3RoO1xuICAgdmFyIG1vYmlsZSA9IHBhcnNlZFRvdGFsSnNvblsnbW9iaWxlJ107XG4gICB2YXIgcmVmV2lkdGg9MDtcbiAgIHZhciByZWZIZWlnaHQgPSAwO1xuICAgdmFyIHRlc3RXaWR0aD0wO1xuICAgdmFyIHRlc3RIZWlnaHQgPSAwO1xuICAgZm9yKHZhciBpPTA7aTxzdHJlYW1Db3VudDtpKyspe1xuICAgXHRcdGlmIChwYXJzZWRUb3RhbEpzb25bJ3JlZmVyZW5jZSddWydzdHJlYW1zJ11baV1bJ2NvZGVjX3R5cGUnXSA9PVwidmlkZW9cIil7XG4gICBcdFx0ICAgcmVmV2lkdGggPSBwYXJzZWRUb3RhbEpzb25bJ3JlZmVyZW5jZSddWydzdHJlYW1zJ11baV1bJ3dpZHRoJ107XG4gICBcdFx0XHRyZWZIZWlnaHQgPXBhcnNlZFRvdGFsSnNvblsncmVmZXJlbmNlJ11bJ3N0cmVhbXMnXVtpXVsnaGVpZ2h0J107XG4gICBcdFx0XHRjb25zb2xlLmxvZyhcInJlZjogXCIrcmVmSGVpZ2h0ICsgXCIgeFwiICtyZWZXaWR0aCk7XG4gICBcdFx0fVxuICAgXHRcdGlmIChwYXJzZWRUb3RhbEpzb25bJ3Rlc3QnXVsnc3RyZWFtcyddW2ldWydjb2RlY190eXBlJ10gPT1cInZpZGVvXCIpe1xuICAgXHRcdCAgIHRlc3RXaWR0aCA9IHBhcnNlZFRvdGFsSnNvblsndGVzdCddWydzdHJlYW1zJ11baV1bJ3dpZHRoJ107XG4gICBcdFx0XHR0ZXN0SGVpZ2h0ID1wYXJzZWRUb3RhbEpzb25bJ3Rlc3QnXVsnc3RyZWFtcyddW2ldWydoZWlnaHQnXTtcbiAgIFx0XHRcdGNvbnNvbGUubG9nKFwidGVzdDogXCIrdGVzdEhlaWdodCArIFwiIHhcIiArdGVzdFdpZHRoKTtcbiAgIFx0XHR9XG4gICBcbiAgIH0gXG4gICBcbiAgIC8vY29uc29sZS5sb2coJ3JlZiB2aWRlbyBpcyAoaHh3KTonK3JlZkhlaWdodCtyZWZXaWR0aCk7XG4gICAvL2FkZCB2aWRlbyB0byB0aGUgcXVldWUgZm9yIHF1YWxpdHkgc2NvcmluZ1xuICBcbiAgIGNvbnN0IGpvYiA9IHZpZGVvUXVhbGl0eVF1ZXVlLmFkZCh7XG4gICAgIGZpbGVJRDogaWQsXG4gICAgIHRlc3RVcmw6IHRlc3QsIFxuICAgICByZWZVcmw6IHJlZixcblx0IG1vYmlsZTogbW9iaWxlLFxuICAgICByZWZWaWRlb0hlaWdodDogcmVmSGVpZ2h0LFxuICAgICByZWZWaWRlb1dpZHRoOiByZWZXaWR0aFxuICAgfSx7cHJpb3JpdHk6IHRlc3RQcmlvcml0eX0pO1xuICAgXG4gICBjb25zb2xlLmxvZyhcImZpbGVpZDpcIiAraWQgK1wibW9iaWxlXCIrbW9iaWxlKTtcbiAgICB0b3RhbEpzb24gPSBKU09OLnBhcnNlKHRvdGFsSnNvbik7XG4gICAgdmFyIHN0YXR1c0NvZGUgPSAxMDA7XG4gICAgaWYgKGFwaT09PXRydWUpe1xuXG4gICAgXHRjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIFx0XHRpZCwgc3RhdHVzQ29kZSwgcmVmSGVpZ2h0LCByZWZXaWR0aCx0ZXN0V2lkdGgsIHRlc3RIZWlnaHQsIHRvdGFsSnNvbiwgbW9iaWxlXG4gICAgXHR9O1xuICAgIFx0Ly9zZW5kIGEgMTAwIG1lYW5pbmcgdGhhdCB0aGUgdGVzdCBpcyBpbiBwcm9jZXNzXG4gICBcdFx0cmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJlc3BvbnNlKTtcbiAgIFx0fSBlbHNle1xuICAgXHRcdCAvL2J1aWxkIGEgcGFnZSBcdFx0IFxuICAgXHRcdCByZXR1cm4gcmVzLnJlbmRlcignaW5kZXgnLCB7XG4gIFx0XHRcdGlkLCBzdGF0dXNDb2RlLCByZWZIZWlnaHQsIHJlZldpZHRoLHRlc3RXaWR0aCwgdGVzdEhlaWdodCwgdG90YWxKc29uLCBtb2JpbGVcblx0XHQgfSk7XG4gICBcdFx0IFxuICAgXHRcdCB9XG4gIFxufSk7XG4gXG4gIFxuXG5cbn0pO1xuXG5hcHAuZ2V0KCcvdGVzdFJlc3VsdHMnLCAocmVxLCByZXMpID0+IHtcbiAgLy9pIGV4cGVjdCB0byBnZXQgdGhlIHV1aWQgdGhhdCBjb3JyZXNwb25kcyB0byBhZmlsZW5hbWVcbiAgbGV0IGlkID0gcmVxLnF1ZXJ5LmlkO1xuICAgICAgbGV0IGFwaSA9ZmFsc2U7XG4gICAgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJmYWxzZVwiICl7XG4gICAgICAgYXBpID0gZmFsc2U7XG4gICAgfWVsc2UgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJ0cnVlXCIgKXtcbiAgICAgXHRhcGkgPSB0cnVlO1xuICAgIH1cbiAgbGV0IG1vYmlsZSA9IHJlcS5xdWVyeS5tb2JpbGU7XG4gIGNvbnNvbGUubG9nKFwibW9iaWxlIG1vZGVsOlwiICsgbW9iaWxlKTtcblx0XG4gIC8vZ2V0IHRoZSBkYXRhIHRoYXQgaXMgc3RvcmVkIG9uIHRoZSBzZXJ2ZXJcbiAgLy9xdWFsaXR5IGRhdGFcbiAgbGV0IGZpbGVuYW1lID0gXCJ0ZXN0X1wiICtpZCsgXCIuanNvblwiO1xuICB2YXIgcmVzdWx0O1xuICB0cnkge1xuICByZXN1bHQgPSBmcy5yZWFkRmlsZVN5bmMocGF0aCArZmlsZW5hbWUsICd1dGY4Jyk7XG59IGNhdGNoIChlcnIpIHtcbiAgICAgLy8gbm8gZmlsZSBmb3VuZCAtIG5vdCByZWFkeSB5ZXRcbiAgICAgdmFyIGluUHJvZ3Jlc3MgPSBKU09OLnBhcnNlKFwie1xcXCJzdGF0dXNDb2RlXFxcIjogMTAxLCBcXFwic3RhdHVzXFxcIjogXFxcIlN0aWxsIHByb2Nlc3NpbmcuIFRyeSBBZ2FpbiBpbiBhIGZldyBtaW51dGVzLlxcXCJ9XCIpO1xuICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoaW5Qcm9ncmVzcyk7XG59XG5cbiAgdmFyIGpzb24gPSBKU09OLnBhcnNlKHJlc3VsdCk7XG4gIHZhciB2aWRlb2pzb24gPSBKU09OLnN0cmluZ2lmeShwYXJzZWRUb3RhbEpzb24pO1xuICBjb25zb2xlLmxvZyh2aWRlb2pzb24pO1xuICB2YXIgc3RhdHVzQ29kZSA9IDIwMDtcbiAgdmFyIFZNQUYgPSBqc29uWydWTUFGIHNjb3JlJ107XG4gIHZhciBQU05SID0ganNvblsnUFNOUiBzY29yZSddO1xuICB2YXIgU1NJTSA9IGpzb25bJ1NTSU0gc2NvcmUnXTtcbiAgdmFyIHJldHVybkpzb24gPSBcIntcXFwiVk1BRlxcXCI6XCIranNvblsnVk1BRiBzY29yZSddK1wiLCBcXFwiUFNOUlxcXCI6XCIranNvblsnUFNOUiBzY29yZSddK1wiLCBcXFwiU1NJTVxcXCI6XCIranNvblsnU1NJTSBzY29yZSddK1wiLCBcXFwibW9iaWxlXFxcIjpcIittb2JpbGUrXCJ9XCI7XG4gIHJldHVybkpzb24gPSBKU09OLnBhcnNlKHJldHVybkpzb24pO1xuICAvL2NvbnNvbGUubG9nKHJldHVybkpzb24pO1xuICB2YXIgc3RhdHVzQ29kZSA9IDIwMDtcbiAgaWYoYXBpKXtcbiAgICBjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIGlkLCBtb2JpbGUsc3RhdHVzQ29kZSxWTUFGLFBTTlIsU1NJTVxuICAgICB9O1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZChyZXNwb25zZSk7XG4gIH1lbHNle1xuICAgICAvL2J1aWxkIGEgcGFnZSBcdFx0IFxuICAgICByZXR1cm4gcmVzLnJlbmRlcigncmVzdWx0cycsIHtcbiAgXHRcdFx0aWQsIG1vYmlsZSxzdGF0dXNDb2RlLFZNQUYsUFNOUixTU0lNXG5cdCB9KTtcbiAgIFx0XHQgXG4gIH1cbiAgXG59KTtcblxuXG5hcHAubGlzdGVuKDE0MzcsICgpID0+XG4gIGNvbnNvbGUubG9nKGBSZWFkeSB0byBwcm9jZXNzIHZpZGVvIGZpbGVzIG9uIHBvcnQgMTQzNyFgKSxcbik7XG5cblxuZnVuY3Rpb24gZmZwcm9iZSh2aWRlb1VybCwgY2FsbGJhY2spe1xuXHR2YXIgZGF0YVN0cmluZyA9IFwiXCI7XG5cdGxldCBwcm9iZSA9IHNwYXduKCdmZnByb2JlJywgWyctaScsIHZpZGVvVXJsLCAnLXNob3dfZm9ybWF0JywnLXNob3dfc3RyZWFtcycsIGAtdmAsICdxdWlldCcsICctcHJpbnRfZm9ybWF0JywgJ2pzb24nXSk7XG4gICAgLy8gY29uc29sZS5sb2coXCJmZnByb2JlXCIgKyB2aWRlb1VybCk7XG4gICAgIHByb2JlLnN0ZG91dC5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgLy8gY29uc29sZS5sb2coXCJkZWJ1Z2dpbmcgRExcIiArZGF0YS5sZW5ndGgpOyAgICAgXHRcbiAgICAgICAgZGF0YVN0cmluZyArPSBkYXRhLnRvU3RyaW5nKCk7XG5cdFx0Y29uc29sZS5sb2coZGF0YVN0cmluZyk7XG4gXHR9KTtcbiBcdHByb2JlLm9uKCdjbG9zZScsIGZ1bmN0aW9uKGNvZGUpIHtcbiBcdFx0Ly9jb25zb2xlLmxvZyhcImNsb3NlOiBcIisgZGF0YVN0cmluZyk7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhkYXRhU3RyaW5nKTtcbiAgICB9KTtcblxufVxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "require",
        "cors",
        "express",
        "uuidv4",
        "pug",
        "Queue",
        "favicon",
        "app",
        "use",
        "json",
        "urlencoded",
        "extended",
        "set",
        "static",
        "moesif",
        "moesifMiddleware",
        "applicationId",
        "logBody",
        "identifyUser",
        "req",
        "res",
        "user",
        "id",
        "undefined",
        "fs",
        "path",
        "parsedTotalJson",
        "test",
        "spawn",
        "videoQualityQueue",
        "limiter",
        "max",
        "duration",
        "concurrency",
        "process",
        "job",
        "done",
        "jobString",
        "JSON",
        "stringify",
        "file",
        "data",
        "fileID",
        "console",
        "log",
        "mobile",
        "ffmpegPromise",
        "Promise",
        "resolve",
        "reject",
        "params",
        "ffmpeg",
        "testUrl",
        "refUrl",
        "refVideoWidth",
        "refVideoHeight",
        "stderr",
        "on",
        "err",
        "String",
        "stdout",
        "Exception",
        "then",
        "successMessage",
        "get",
        "render",
        "url",
        "query",
        "probeJson",
        "ffprobe",
        "result",
        "resultJson",
        "value",
        "parsedprobeJson",
        "parse",
        "status",
        "send",
        "ref",
        "refurl",
        "testurl",
        "api",
        "mobilemodel",
        "testPriority",
        "pri",
        "totalJson",
        "jsonCombinedPromise",
        "refresult",
        "testresult",
        "combinedJson",
        "streamCount",
        "length",
        "refWidth",
        "refHeight",
        "testWidth",
        "testHeight",
        "i",
        "add",
        "priority",
        "statusCode",
        "response",
        "filename",
        "readFileSync",
        "inProgress",
        "videojson",
        "VMAF",
        "PSNR",
        "SSIM",
        "returnJson",
        "listen",
        "videoUrl",
        "callback",
        "dataString",
        "probe",
        "toString",
        "code"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/dougsillars/Documents/Github/StreamClarity/vmafscan/src",
      "sourcesContent": [
        "//https://www.robinwieruch.de/minimal-node-js-babel-setup\n//great node tutorial\n\n\nrequire('dotenv/config');\nconst cors = require('cors');\nconst express =require('express');\nconst uuidv4 =require('uuid/v4');\n\n//import cors from 'cors';\n//import express from 'express';\n//import uuidv4 from 'uuid/v4';\n\nconst pug = require('pug');\n//bull for queuing the vmaf ffmpeg jons\nvar Queue = require('bull');\nvar favicon = require('serve-favicon');\nconst app = express();\napp.use(favicon('public/icon.ico')); \napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\napp.set('view engine','pug');\napp.use(express.static('public/'));\n\n//moesif\nvar moesif = require('moesif-express');\n// 2. Set the options, the only required field is applicationId\nvar moesifMiddleware = moesif({\n  applicationId: 'eyJhcHAiOiI1MTk6MTQ3IiwidmVyIjoiMi4wIiwib3JnIjoiMjQwOjIxMCIsImlhdCI6MTU5Mjg3MDQwMH0.rcYbuEeoN8kSUiopSYFy6ZAhThA0ZGaJLsavzWqaOoQ',\n  // Set to false if you don't want to capture req/resp body\n  logBody: true,\n\n  // Optional hook to link API calls to users\n  identifyUser: function (req, res) {\n    return req.user ? req.user.id : undefined;\n  },\n});\n\n// 3. Enable the Moesif middleware to start capturing incoming API Calls\napp.use(moesifMiddleware);\n\n\n//read files\nvar fs = require('fs');\n//var http = require('http');\n//var https = require('https');\n\nvar path = \"../tests/\"\nvar parsedTotalJson=\"\";\nlet test= {};\nconst spawn = require('child_process').spawn;\n\n//create the video queue\n//queue allows 2 jobs at a time\nconst videoQualityQueue = new Queue('ffmpeg-processing-qualityMetrics', {\n  limiter: {\n    max: 1, \n    duration: 1000\n  }\n});\n\nconst concurrency = 1;\nvideoQualityQueue.process(concurrency, function(job, done) {\n    var jobString = JSON.stringify(job);\n    var file = \"test_\" +job.data.fileID+ \".json\";\n    console.log(path+file);\n\tconsole.log(\"mobile?\" +job.data.mobile);\n    var ffmpegPromise = new Promise(function(resolve, reject) {\n\t\tvar params = ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:phone_model=true:log_fmt=json:log_path=';\n\t\tif(!job.data.mobile){\n\t\t\tparams = ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:log_fmt=json:log_path='\n\t\t}\n\t\tconsole.log(\"mobile: \" +job.data.mobile);\n\t\tconsole.log(\"params: \" +params);\n         try {\n    \t\tlet ffmpeg = spawn('ffmpeg', ['-i', job.data.testUrl, '-i', job.data.refUrl, '-filter_complex', '[0:v]scale='+job.data.refVideoWidth+'x'+job.data.refVideoHeight+params+path+file, `-f`, 'null', '-']);\n    \t\tconsole.log(\"running test id:\" +job.data.fileID); \n    \t\tffmpeg.stderr.on('data', (err) => {\n            \tconsole.log('err:', new String(err));\n            \t\n    \t\t});\n    \t\tffmpeg.stdout.on('data', function(){ \n    \t\t\t\tconsole.log('stdout');\n    \t\t\t\tresolve(\"success!\");\n    \t\t\t\t\n    \t\t }); \n    \t  }\n    \t  catch (Exception){ \n    \t\t\treject(\"error in promise\");\n    \t  }\n    \t\n    });\n    return ffmpegPromise.then(function(successMessage){\n    \t\tconsole.log(successMessage);\n    \t\tdone();\n    \t\t\n    });\n});\n\napp.get('/',  (req, res) => {\n     return res.render('landing');\n});\n\napp.get('/probe', (req,res) =>{\n\tlet url = req.query.url;\n\tconsole.log(\"testurl=\"+url);\n\tvar probeJson = new Promise(function(resolve, reject) {\n  \t      \n  \t    try{  \n  \t      ffprobe(url, function(result) { \n    \t\t\t//create combined JSON file\n    \t\t\tvar resultJson = result;\n    \t\t\t\n    \t\t\tresolve(resultJson);\n           });\n          } \n          catch(Exception){\n          \treject(\"error in ffprobe promise\");\n          }\n    });\n    probeJson.then(function(value) {\n//     console.log(\"total json promise:\"+ totalJson);\n     //compare the 2 videos\n     //no longer have to be the same size!!!\n       var parsedprobeJson = JSON.parse(value);\n       console.log(\"parsed json\" + value);\n       //const response = {parsedprobeJson};\n       return res.status(200).send(parsedprobeJson);\n   });\n       \n});\n \n\napp.get('/test', (req, res) => {\n    //get urls\n    //i exect 2 params reference url ref, test url test\n\t//i expect 3 parameters reference url ref, test url test, and mobile model\n    let ref = req.query.refurl;\n    let test = req.query.testurl;\n    let api =false;\n\tlet mobile = true;\n    \n\t\n    if (req.query.api == \"false\" ){\n       api = false;\n    }else if (req.query.api == \"true\" ){\n     \tapi = true;\n    }\n \n    if (req.query.mobilemodel == \"on\" ){\n     \tmobile = true;\n    }else{ mobile=false;}\n\t\n    let testPriority = 5;\n    if (req.query.pri !== {}){\n      testPriority = req.query.pri;\n    }\n\n    //console.log(\"api: \" +api);\n    //create unique ID\n    const id = uuidv4();\n    \n    //get ffprobe format data of both files, and then run the vmaf comparison \n    var totalJson = \"\";\n    var jsonCombinedPromise = new Promise(function(resolve, reject) {\n  \t      \n  \t    try{  \n  \t      ffprobe(ref, function(refresult) { \n    \t\tffprobe(test, function(testresult) {\n    \t\t\t//create combined JSON file\n    \t\t\tvar combinedJson = \"{\\\"test\\\":\"+ testresult+\",\\\"reference\\\":\"+refresult+\",\\\"mobile\\\":\"+mobile+\"}\"\n    \t\t\tresolve(combinedJson);\n    \t\t});\n           });\n          } \n          catch(Exception){\n          \treject(\"error in ffprobe promise\");\n          }   \n});\n\n\n\njsonCombinedPromise.then(function(value) {\n  totalJson = value;\n//  console.log(\"total json promise:\"+ totalJson);\n   //compare the 2 videos\n   //no longer have to be the same size!!!\n   parsedTotalJson = JSON.parse(totalJson);\n   console.log(parsedTotalJson);\n   var streamCount = parsedTotalJson['reference']['streams'].length;\n   var mobile = parsedTotalJson['mobile'];\n   var refWidth=0;\n   var refHeight = 0;\n   var testWidth=0;\n   var testHeight = 0;\n   for(var i=0;i<streamCount;i++){\n   \t\tif (parsedTotalJson['reference']['streams'][i]['codec_type'] ==\"video\"){\n   \t\t   refWidth = parsedTotalJson['reference']['streams'][i]['width'];\n   \t\t\trefHeight =parsedTotalJson['reference']['streams'][i]['height'];\n   \t\t\tconsole.log(\"ref: \"+refHeight + \" x\" +refWidth);\n   \t\t}\n   \t\tif (parsedTotalJson['test']['streams'][i]['codec_type'] ==\"video\"){\n   \t\t   testWidth = parsedTotalJson['test']['streams'][i]['width'];\n   \t\t\ttestHeight =parsedTotalJson['test']['streams'][i]['height'];\n   \t\t\tconsole.log(\"test: \"+testHeight + \" x\" +testWidth);\n   \t\t}\n   \n   } \n   \n   //console.log('ref video is (hxw):'+refHeight+refWidth);\n   //add video to the queue for quality scoring\n  \n   const job = videoQualityQueue.add({\n     fileID: id,\n     testUrl: test, \n     refUrl: ref,\n\t mobile: mobile,\n     refVideoHeight: refHeight,\n     refVideoWidth: refWidth\n   },{priority: testPriority});\n   \n   console.log(\"fileid:\" +id +\"mobile\"+mobile);\n    totalJson = JSON.parse(totalJson);\n    var statusCode = 100;\n    if (api===true){\n\n    \tconst response = {\n      \t\tid, statusCode, refHeight, refWidth,testWidth, testHeight, totalJson, mobile\n    \t};\n    \t//send a 100 meaning that the test is in process\n   \t\treturn res.status(200).send(response);\n   \t} else{\n   \t\t //build a page \t\t \n   \t\t return res.render('index', {\n  \t\t\tid, statusCode, refHeight, refWidth,testWidth, testHeight, totalJson, mobile\n\t\t });\n   \t\t \n   \t\t }\n  \n});\n \n  \n\n\n});\n\napp.get('/testResults', (req, res) => {\n  //i expect to get the uuid that corresponds to afilename\n  let id = req.query.id;\n      let api =false;\n    if (req.query.api == \"false\" ){\n       api = false;\n    }else if (req.query.api == \"true\" ){\n     \tapi = true;\n    }\n  let mobile = req.query.mobile;\n  console.log(\"mobile model:\" + mobile);\n\t\n  //get the data that is stored on the server\n  //quality data\n  let filename = \"test_\" +id+ \".json\";\n  var result;\n  try {\n  result = fs.readFileSync(path +filename, 'utf8');\n} catch (err) {\n     // no file found - not ready yet\n     var inProgress = JSON.parse(\"{\\\"statusCode\\\": 101, \\\"status\\\": \\\"Still processing. Try Again in a few minutes.\\\"}\");\n     return res.status(200).send(inProgress);\n}\n\n  var json = JSON.parse(result);\n  var videojson = JSON.stringify(parsedTotalJson);\n  console.log(videojson);\n  var statusCode = 200;\n  var VMAF = json['VMAF score'];\n  var PSNR = json['PSNR score'];\n  var SSIM = json['SSIM score'];\n  var returnJson = \"{\\\"VMAF\\\":\"+json['VMAF score']+\", \\\"PSNR\\\":\"+json['PSNR score']+\", \\\"SSIM\\\":\"+json['SSIM score']+\", \\\"mobile\\\":\"+mobile+\"}\";\n  returnJson = JSON.parse(returnJson);\n  //console.log(returnJson);\n  var statusCode = 200;\n  if(api){\n    const response = {\n      id, mobile,statusCode,VMAF,PSNR,SSIM\n     };\n    return res.status(200).send(response);\n  }else{\n     //build a page \t\t \n     return res.render('results', {\n  \t\t\tid, mobile,statusCode,VMAF,PSNR,SSIM\n\t });\n   \t\t \n  }\n  \n});\n\n\napp.listen(1437, () =>\n  console.log(`Ready to process video files on port 1437!`),\n);\n\n\nfunction ffprobe(videoUrl, callback){\n\tvar dataString = \"\";\n\tlet probe = spawn('ffprobe', ['-i', videoUrl, '-show_format','-show_streams', `-v`, 'quiet', '-print_format', 'json']);\n    // console.log(\"ffprobe\" + videoUrl);\n     probe.stdout.on('data', (data) => {\n       // console.log(\"debugging DL\" +data.length);     \t\n        dataString += data.toString();\n\t\tconsole.log(dataString);\n \t});\n \tprobe.on('close', function(code) {\n \t\t//console.log(\"close: \"+ dataString);\n        return callback(dataString);\n    });\n\n}\n"
      ]
    },
    "sourceType": "module",
    "mtime": 1592894656253
  },
  "{\"sourceRoot\":\"/Users/dougsillars/Documents/Github/StreamClarity/src\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/dougsillars/Documents/Github/StreamClarity\",\"filename\":\"/Users/dougsillars/Documents/Github/StreamClarity/src/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/dougsillars/Documents/Github/StreamClarity\",\"plugins\":[],\"presets\":[]}:7.5.5": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/dougsillars/Documents/Github/StreamClarity/src",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/dougsillars/Documents/Github/StreamClarity",
      "filename": "/Users/dougsillars/Documents/Github/StreamClarity/src/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/dougsillars/Documents/Github/StreamClarity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/dougsillars/Documents/Github/StreamClarity/src/index.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "/Users/dougsillars/Documents/Github/StreamClarity/src/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/dougsillars/Documents/Github/StreamClarity/src",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "//https://www.robinwieruch.de/minimal-node-js-babel-setup\n//great node tutorial\nrequire('dotenv/config');\n\nconst cors = require('cors');\n\nconst express = require('express');\n\nconst uuidv4 = require('uuid/v4'); //import cors from 'cors';\n//import express from 'express';\n//import uuidv4 from 'uuid/v4';\n\n\nconst pug = require('pug'); //bull for queuing the vmaf ffmpeg jons\n\n\nvar Queue = require('bull');\n\nvar favicon = require('serve-favicon');\n\nconst app = express();\napp.use(favicon('public/icon.ico'));\napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({\n  extended: true\n}));\napp.set('view engine', 'pug');\napp.use(express.static('public/')); //read files\n\nvar fs = require('fs'); //var http = require('http');\n//var https = require('https');\n\n\napp.get('/', (req, res) => {\n  return res.render('landing');\n});\napp.get('/probe', (req, res) => {\n  let url = req.query.url;\n  console.log(\"testurl=\" + url);\n  var probeJson = new Promise(function (resolve, reject) {\n    try {\n      ffprobe(url, function (result) {\n        //create combined JSON file\n        var resultJson = result;\n        resolve(resultJson);\n      });\n    } catch (Exception) {\n      reject(\"error in ffprobe promise\");\n    }\n  });\n  probeJson.then(function (value) {\n    //     console.log(\"total json promise:\"+ totalJson);\n    //compare the 2 videos\n    //no longer have to be the same size!!!\n    var parsedprobeJson = JSON.parse(value);\n    console.log(\"parsed json\" + value); //const response = {parsedprobeJson};\n\n    return res.status(200).send(parsedprobeJson);\n  });\n  var path = \"../tests/\";\n  var parsedTotalJson = \"\";\n  let test = {};\n\n  const spawn = require('child_process').spawn; //create the video queue\n  //queue allows 2 jobs at a time\n\n\n  const videoQualityQueue = new Queue('ffmpeg-processing-qualityMetrics', {\n    limiter: {\n      max: 1,\n      duration: 1000\n    }\n  });\n  const concurrency = 1;\n  videoQualityQueue.process(concurrency, function (job, done) {\n    var jobString = JSON.stringify(job);\n    var file = \"test_\" + job.data.fileID + \".json\";\n    console.log(path + file);\n    console.log(\"mobile?\" + job.data.mobile);\n    var ffmpegPromise = new Promise(function (resolve, reject) {\n      var params = ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:phone_model=true:log_fmt=json:log_path=';\n\n      if (!job.data.mobile) {\n        params = ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:log_fmt=json:log_path=';\n      }\n\n      console.log(\"mobile: \" + job.data.mobile);\n      console.log(\"params: \" + params);\n\n      try {\n        let ffmpeg = spawn('ffmpeg', ['-i', job.data.testUrl, '-i', job.data.refUrl, '-filter_complex', '[0:v]scale=' + job.data.refVideoWidth + 'x' + job.data.refVideoHeight + params + path + file, `-f`, 'null', '-']);\n        console.log(\"running test id:\" + job.data.fileID);\n        ffmpeg.stderr.on('data', err => {\n          console.log('err:', new String(err));\n        });\n        ffmpeg.stdout.on('data', function () {\n          console.log('stdout');\n          resolve(\"success!\");\n        });\n      } catch (Exception) {\n        reject(\"error in promise\");\n      }\n    });\n    return ffmpegPromise.then(function (successMessage) {\n      console.log(successMessage);\n      done();\n    });\n  });\n});\napp.get('/test', (req, res) => {\n  //get urls\n  //i exect 2 params reference url ref, test url test\n  //i expect 3 parameters reference url ref, test url test, and mobile model\n  let ref = req.query.refurl;\n  let test = req.query.testurl;\n  let api = false;\n  let mobile = true;\n\n  if (req.query.api == \"false\") {\n    api = false;\n  } else if (req.query.api == \"true\") {\n    api = true;\n  }\n\n  if (req.query.mobilemodel == \"on\") {\n    mobile = true;\n  } else {\n    mobile = false;\n  }\n\n  let testPriority = 5;\n\n  if (req.query.pri !== {}) {\n    testPriority = req.query.pri;\n  } //console.log(\"api: \" +api);\n  //create unique ID\n\n\n  const id = uuidv4(); //get ffprobe format data of both files, and then run the vmaf comparison \n\n  var totalJson = \"\";\n  var jsonCombinedPromise = new Promise(function (resolve, reject) {\n    try {\n      ffprobe(ref, function (refresult) {\n        ffprobe(test, function (testresult) {\n          //create combined JSON file\n          var combinedJson = \"{\\\"test\\\":\" + testresult + \",\\\"reference\\\":\" + refresult + \",\\\"mobile\\\":\" + mobile + \"}\";\n          resolve(combinedJson);\n        });\n      });\n    } catch (Exception) {\n      reject(\"error in ffprobe promise\");\n    }\n  });\n  jsonCombinedPromise.then(function (value) {\n    totalJson = value; //  console.log(\"total json promise:\"+ totalJson);\n    //compare the 2 videos\n    //no longer have to be the same size!!!\n\n    parsedTotalJson = JSON.parse(totalJson);\n    console.log(parsedTotalJson);\n    var streamCount = parsedTotalJson['reference']['streams'].length;\n    var mobile = parsedTotalJson['mobile'];\n    var refWidth = 0;\n    var refHeight = 0;\n    var testWidth = 0;\n    var testHeight = 0;\n\n    for (var i = 0; i < streamCount; i++) {\n      if (parsedTotalJson['reference']['streams'][i]['codec_type'] == \"video\") {\n        refWidth = parsedTotalJson['reference']['streams'][i]['width'];\n        refHeight = parsedTotalJson['reference']['streams'][i]['height'];\n        console.log(\"ref: \" + refHeight + \" x\" + refWidth);\n      }\n\n      if (parsedTotalJson['test']['streams'][i]['codec_type'] == \"video\") {\n        testWidth = parsedTotalJson['test']['streams'][i]['width'];\n        testHeight = parsedTotalJson['test']['streams'][i]['height'];\n        console.log(\"test: \" + testHeight + \" x\" + testWidth);\n      }\n    } //console.log('ref video is (hxw):'+refHeight+refWidth);\n    //add video to the queue for quality scoring\n\n\n    const job = videoQualityQueue.add({\n      fileID: id,\n      testUrl: test,\n      refUrl: ref,\n      mobile: mobile,\n      refVideoHeight: refHeight,\n      refVideoWidth: refWidth\n    }, {\n      priority: testPriority\n    });\n    console.log(\"fileid:\" + id + \"mobile\" + mobile);\n    totalJson = JSON.parse(totalJson);\n    var statusCode = 100;\n\n    if (api === true) {\n      const response = {\n        id,\n        statusCode,\n        refHeight,\n        refWidth,\n        testWidth,\n        testHeight,\n        totalJson,\n        mobile\n      }; //send a 100 meaning that the test is in process\n\n      return res.status(200).send(response);\n    } else {\n      //build a page \t\t \n      return res.render('index', {\n        id,\n        statusCode,\n        refHeight,\n        refWidth,\n        testWidth,\n        testHeight,\n        totalJson,\n        mobile\n      });\n    }\n  });\n});\napp.get('/testResults', (req, res) => {\n  //i expect to get the uuid that corresponds to afilename\n  let id = req.query.id;\n  let api = false;\n\n  if (req.query.api == \"false\") {\n    api = false;\n  } else if (req.query.api == \"true\") {\n    api = true;\n  }\n\n  let mobile = req.query.mobile;\n  console.log(\"mobile model:\" + mobile); //get the data that is stored on the server\n  //quality data\n\n  let filename = \"test_\" + id + \".json\";\n  var result;\n\n  try {\n    result = fs.readFileSync(path + filename, 'utf8');\n  } catch (err) {\n    // no file found - not ready yet\n    var inProgress = JSON.parse(\"{\\\"statusCode\\\": 101, \\\"status\\\": \\\"Still processing. Try Again in a few minutes.\\\"}\");\n    return res.status(200).send(inProgress);\n  }\n\n  var json = JSON.parse(result);\n  var videojson = JSON.stringify(parsedTotalJson);\n  console.log(videojson);\n  var statusCode = 200;\n  var VMAF = json['VMAF score'];\n  var PSNR = json['PSNR score'];\n  var SSIM = json['SSIM score'];\n  var returnJson = \"{\\\"VMAF\\\":\" + json['VMAF score'] + \", \\\"PSNR\\\":\" + json['PSNR score'] + \", \\\"SSIM\\\":\" + json['SSIM score'] + \", \\\"mobile\\\":\" + mobile + \"}\";\n  returnJson = JSON.parse(returnJson); //console.log(returnJson);\n\n  var statusCode = 200;\n\n  if (api) {\n    const response = {\n      id,\n      mobile,\n      statusCode,\n      VMAF,\n      PSNR,\n      SSIM\n    };\n    return res.status(200).send(response);\n  } else {\n    //build a page \t\t \n    return res.render('results', {\n      id,\n      mobile,\n      statusCode,\n      VMAF,\n      PSNR,\n      SSIM\n    });\n  }\n});\napp.listen(1437, () => console.log(`Ready to process video files on port 1437!`));\n\nfunction ffprobe(videoUrl, callback) {\n  var dataString = \"\";\n  let probe = spawn('ffprobe', ['-i', videoUrl, '-show_format', '-show_streams', `-v`, 'quiet', '-print_format', 'json']); // console.log(\"ffprobe\" + videoUrl);\n\n  probe.stdout.on('data', data => {\n    // console.log(\"debugging DL\" +data.length);     \t\n    dataString += data.toString();\n    console.log(dataString);\n  });\n  probe.on('close', function (code) {\n    //console.log(\"close: \"+ dataString);\n    return callback(dataString);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJjb3JzIiwiZXhwcmVzcyIsInV1aWR2NCIsInB1ZyIsIlF1ZXVlIiwiZmF2aWNvbiIsImFwcCIsInVzZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJzZXQiLCJzdGF0aWMiLCJmcyIsImdldCIsInJlcSIsInJlcyIsInJlbmRlciIsInVybCIsInF1ZXJ5IiwiY29uc29sZSIsImxvZyIsInByb2JlSnNvbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZmZwcm9iZSIsInJlc3VsdCIsInJlc3VsdEpzb24iLCJFeGNlcHRpb24iLCJ0aGVuIiwidmFsdWUiLCJwYXJzZWRwcm9iZUpzb24iLCJKU09OIiwicGFyc2UiLCJzdGF0dXMiLCJzZW5kIiwicGF0aCIsInBhcnNlZFRvdGFsSnNvbiIsInRlc3QiLCJzcGF3biIsInZpZGVvUXVhbGl0eVF1ZXVlIiwibGltaXRlciIsIm1heCIsImR1cmF0aW9uIiwiY29uY3VycmVuY3kiLCJwcm9jZXNzIiwiam9iIiwiZG9uZSIsImpvYlN0cmluZyIsInN0cmluZ2lmeSIsImZpbGUiLCJkYXRhIiwiZmlsZUlEIiwibW9iaWxlIiwiZmZtcGVnUHJvbWlzZSIsInBhcmFtcyIsImZmbXBlZyIsInRlc3RVcmwiLCJyZWZVcmwiLCJyZWZWaWRlb1dpZHRoIiwicmVmVmlkZW9IZWlnaHQiLCJzdGRlcnIiLCJvbiIsImVyciIsIlN0cmluZyIsInN0ZG91dCIsInN1Y2Nlc3NNZXNzYWdlIiwicmVmIiwicmVmdXJsIiwidGVzdHVybCIsImFwaSIsIm1vYmlsZW1vZGVsIiwidGVzdFByaW9yaXR5IiwicHJpIiwiaWQiLCJ0b3RhbEpzb24iLCJqc29uQ29tYmluZWRQcm9taXNlIiwicmVmcmVzdWx0IiwidGVzdHJlc3VsdCIsImNvbWJpbmVkSnNvbiIsInN0cmVhbUNvdW50IiwibGVuZ3RoIiwicmVmV2lkdGgiLCJyZWZIZWlnaHQiLCJ0ZXN0V2lkdGgiLCJ0ZXN0SGVpZ2h0IiwiaSIsImFkZCIsInByaW9yaXR5Iiwic3RhdHVzQ29kZSIsInJlc3BvbnNlIiwiZmlsZW5hbWUiLCJyZWFkRmlsZVN5bmMiLCJpblByb2dyZXNzIiwidmlkZW9qc29uIiwiVk1BRiIsIlBTTlIiLCJTU0lNIiwicmV0dXJuSnNvbiIsImxpc3RlbiIsInZpZGVvVXJsIiwiY2FsbGJhY2siLCJkYXRhU3RyaW5nIiwicHJvYmUiLCJ0b1N0cmluZyIsImNvZGUiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFHQUEsT0FBTyxDQUFDLGVBQUQsQ0FBUDs7QUFDQSxNQUFNQyxJQUFJLEdBQUdELE9BQU8sQ0FBQyxNQUFELENBQXBCOztBQUNBLE1BQU1FLE9BQU8sR0FBRUYsT0FBTyxDQUFDLFNBQUQsQ0FBdEI7O0FBQ0EsTUFBTUcsTUFBTSxHQUFFSCxPQUFPLENBQUMsU0FBRCxDQUFyQixDLENBRUE7QUFDQTtBQUNBOzs7QUFFQSxNQUFNSSxHQUFHLEdBQUdKLE9BQU8sQ0FBQyxLQUFELENBQW5CLEMsQ0FDQTs7O0FBQ0EsSUFBSUssS0FBSyxHQUFHTCxPQUFPLENBQUMsTUFBRCxDQUFuQjs7QUFDQSxJQUFJTSxPQUFPLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQXJCOztBQUNBLE1BQU1PLEdBQUcsR0FBR0wsT0FBTyxFQUFuQjtBQUNBSyxHQUFHLENBQUNDLEdBQUosQ0FBUUYsT0FBTyxDQUFDLGlCQUFELENBQWY7QUFDQUMsR0FBRyxDQUFDQyxHQUFKLENBQVFQLElBQUksRUFBWjtBQUNBTSxHQUFHLENBQUNDLEdBQUosQ0FBUU4sT0FBTyxDQUFDTyxJQUFSLEVBQVI7QUFDQUYsR0FBRyxDQUFDQyxHQUFKLENBQVFOLE9BQU8sQ0FBQ1EsVUFBUixDQUFtQjtBQUFFQyxFQUFBQSxRQUFRLEVBQUU7QUFBWixDQUFuQixDQUFSO0FBQ0FKLEdBQUcsQ0FBQ0ssR0FBSixDQUFRLGFBQVIsRUFBc0IsS0FBdEI7QUFDQUwsR0FBRyxDQUFDQyxHQUFKLENBQVFOLE9BQU8sQ0FBQ1csTUFBUixDQUFl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aEYsT0FBTyxDQUFDQyxHQUFSLENBQWEsNENBQWIsQ0FERjs7QUFLQSxTQUFTSyxPQUFULENBQWlCMkUsUUFBakIsRUFBMkJDLFFBQTNCLEVBQW9DO0FBQ25DLE1BQUlDLFVBQVUsR0FBRyxFQUFqQjtBQUNBLE1BQUlDLEtBQUssR0FBR2hFLEtBQUssQ0FBQyxTQUFELEVBQVksQ0FBQyxJQUFELEVBQU82RCxRQUFQLEVBQWlCLGNBQWpCLEVBQWdDLGVBQWhDLEVBQWtELElBQWxELEVBQXVELE9BQXZELEVBQWdFLGVBQWhFLEVBQWlGLE1BQWpGLENBQVosQ0FBakIsQ0FGbUMsQ0FHaEM7O0FBQ0NHLEVBQUFBLEtBQUssQ0FBQ3RDLE1BQU4sQ0FBYUgsRUFBYixDQUFnQixNQUFoQixFQUF5QlgsSUFBRCxJQUFVO0FBQ2hDO0FBQ0NtRCxJQUFBQSxVQUFVLElBQUluRCxJQUFJLENBQUNxRCxRQUFMLEVBQWQ7QUFDTnJGLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZa0YsVUFBWjtBQUNDLEdBSkU7QUFLSEMsRUFBQUEsS0FBSyxDQUFDekMsRUFBTixDQUFTLE9BQVQsRUFBa0IsVUFBUzJDLElBQVQsRUFBZTtBQUNoQztBQUNLLFdBQU9KLFFBQVEsQ0FBQ0MsVUFBRCxDQUFmO0FBQ0gsR0FISDtBQUtEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9kb3Vnc2lsbGFycy9Eb2N1bWVudHMvR2l0aHViL1N0cmVhbUNsYXJpdHkvc3JjIiwic291cmNlc0NvbnRlbnQiOlsiLy9odHRwczovL3d3dy5yb2JpbndpZXJ1Y2guZGUvbWluaW1hbC1ub2RlLWpzLWJhYmVsLXNldHVwXG4vL2dyZWF0IG5vZGUgdHV0b3JpYWxcblxuXG5yZXF1aXJlKCdkb3RlbnYvY29uZmlnJyk7XG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpO1xuY29uc3QgZXhwcmVzcyA9cmVxdWlyZSgnZXhwcmVzcycpO1xuY29uc3QgdXVpZHY0ID1yZXF1aXJlKCd1dWlkL3Y0Jyk7XG5cbi8vaW1wb3J0IGNvcnMgZnJvbSAnY29ycyc7XG4vL2ltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuLy9pbXBvcnQgdXVpZHY0IGZyb20gJ3V1aWQvdjQnO1xuXG5jb25zdCBwdWcgPSByZXF1aXJlKCdwdWcnKTtcbi8vYnVsbCBmb3IgcXVldWluZyB0aGUgdm1hZiBmZm1wZWcgam9uc1xudmFyIFF1ZXVlID0gcmVxdWlyZSgnYnVsbCcpO1xudmFyIGZhdmljb24gPSByZXF1aXJlKCdzZXJ2ZS1mYXZpY29uJyk7XG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5hcHAudXNlKGZhdmljb24oJ3B1YmxpYy9pY29uLmljbycpKTsgXG5hcHAudXNlKGNvcnMoKSk7XG5hcHAudXNlKGV4cHJlc3MuanNvbigpKTtcbmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpO1xuYXBwLnNldCgndmlldyBlbmdpbmUnLCdwdWcnKTtcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMoJ3B1YmxpYy8nKSk7XG5cblxuLy9yZWFkIGZpbGVzXG52YXIgZnMgPSByZXF1aXJlKCdmcycpO1xuLy92YXIgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTtcbi8vdmFyIGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKTtcblxuXG5cbmFwcC5nZXQoJy8nLCAgKHJlcSwgcmVzKSA9PiB7XG4gICAgIHJldHVybiByZXMucmVuZGVyKCdsYW5kaW5nJyk7XG59KTtcblxuYXBwLmdldCgnL3Byb2JlJywgKHJlcSxyZXMpID0+e1xuXHRsZXQgdXJsID0gcmVxLnF1ZXJ5LnVybDtcblx0Y29uc29sZS5sb2coXCJ0ZXN0dXJsPVwiK3VybCk7XG5cdHZhciBwcm9iZUpzb24gPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgXHQgICAgICBcbiAgXHQgICAgdHJ5eyAgXG4gIFx0ICAgICAgZmZwcm9iZSh1cmwsIGZ1bmN0aW9uKHJlc3VsdCkgeyBcbiAgICBcdFx0XHQvL2NyZWF0ZSBjb21iaW5lZCBKU09OIGZpbGVcbiAgICBcdFx0XHR2YXIgcmVzdWx0SnNvbiA9IHJlc3VsdDtcbiAgICBcdFx0XHRcbiAgICBcdFx0XHRyZXNvbHZlKHJlc3VsdEpzb24pO1xuICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IFxuICAgICAgICAgIGNhdGNoKEV4Y2VwdGlvbil7XG4gICAgICAgICAgXHRyZWplY3QoXCJlcnJvciBpbiBmZnByb2JlIHByb21pc2VcIik7XG4gICAgICAgICAgfVxuICAgIH0pO1xuICAgIHByb2JlSnNvbi50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4vLyAgICAgY29uc29sZS5sb2coXCJ0b3RhbCBqc29uIHByb21pc2U6XCIrIHRvdGFsSnNvbik7XG4gICAgIC8vY29tcGFyZSB0aGUgMiB2aWRlb3NcbiAgICAgLy9ubyBsb25nZXIgaGF2ZSB0byBiZSB0aGUgc2FtZSBzaXplISEhXG4gICAgICAgdmFyIHBhcnNlZHByb2JlSnNvbiA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgIGNvbnNvbGUubG9nKFwicGFyc2VkIGpzb25cIiArIHZhbHVlKTtcbiAgICAgICAvL2NvbnN0IHJlc3BvbnNlID0ge3BhcnNlZHByb2JlSnNvbn07XG4gICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHBhcnNlZHByb2JlSnNvbik7XG4gICB9KTtcbiAgIHZhciBwYXRoID0gXCIuLi90ZXN0cy9cIlxudmFyIHBhcnNlZFRvdGFsSnNvbj1cIlwiO1xubGV0IHRlc3Q9IHt9O1xuY29uc3Qgc3Bhd24gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuc3Bhd247XG5cbi8vY3JlYXRlIHRoZSB2aWRlbyBxdWV1ZVxuLy9xdWV1ZSBhbGxvd3MgMiBqb2JzIGF0IGEgdGltZVxuY29uc3QgdmlkZW9RdWFsaXR5UXVldWUgPSBuZXcgUXVldWUoJ2ZmbXBlZy1wcm9jZXNzaW5nLXF1YWxpdHlNZXRyaWNzJywge1xuICBsaW1pdGVyOiB7XG4gICAgbWF4OiAxLCBcbiAgICBkdXJhdGlvbjogMTAwMFxuICB9XG59KTtcblxuY29uc3QgY29uY3VycmVuY3kgPSAxO1xudmlkZW9RdWFsaXR5UXVldWUucHJvY2Vzcyhjb25jdXJyZW5jeSwgZnVuY3Rpb24oam9iLCBkb25lKSB7XG4gICAgdmFyIGpvYlN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGpvYik7XG4gICAgdmFyIGZpbGUgPSBcInRlc3RfXCIgK2pvYi5kYXRhLmZpbGVJRCsgXCIuanNvblwiO1xuICAgIGNvbnNvbGUubG9nKHBhdGgrZmlsZSk7XG5cdGNvbnNvbGUubG9nKFwibW9iaWxlP1wiICtqb2IuZGF0YS5tb2JpbGUpO1xuICAgIHZhciBmZm1wZWdQcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBwYXJhbXMgPSAnOmZsYWdzPWJpY3ViaWNbbWFpbl07W21haW5dWzE6dl1saWJ2bWFmPXNzaW09dHJ1ZTpwc25yPXRydWU6cGhvbmVfbW9kZWw9dHJ1ZTpsb2dfZm10PWpzb246bG9nX3BhdGg9JztcbiAgICAgICAgaWYoIWpvYi5kYXRhLm1vYmlsZSl7XG4gICAgICAgICAgcGFyYW1zID0gJzpmbGFncz1iaWN1YmljW21haW5dO1ttYWluXVsxOnZdbGlidm1hZj1zc2ltPXRydWU6cHNucj10cnVlOmxvZ19mbXQ9anNvbjpsb2dfcGF0aD0nXG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCJtb2JpbGU6IFwiICtqb2IuZGF0YS5tb2JpbGUpO1xuICAgICAgICBjb25zb2xlLmxvZyhcInBhcmFtczogXCIgK3BhcmFtcyk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgbGV0IGZmbXBlZyA9IHNwYXduKCdmZm1wZWcnLCBbJy1pJywgam9iLmRhdGEudGVzdFVybCwgJy1pJywgam9iLmRhdGEucmVmVXJsLCAnLWZpbHRlcl9jb21wbGV4JywgJ1swOnZdc2NhbGU9Jytqb2IuZGF0YS5yZWZWaWRlb1dpZHRoKyd4Jytqb2IuZGF0YS5yZWZWaWRlb0hlaWdodCtwYXJhbXMrcGF0aCtmaWxlLCBgLWZgLCAnbnVsbCcsICctJ10pO1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJydW5uaW5nIHRlc3QgaWQ6XCIgK2pvYi5kYXRhLmZpbGVJRCk7IFxuICAgICAgICAgICAgICAgICAgZmZtcGVnLnN0ZGVyci5vbignZGF0YScsIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgbmV3IFN0cmluZyhlcnIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBmZm1wZWcuc3Rkb3V0Lm9uKCdkYXRhJywgZnVuY3Rpb24oKXsgXG4gICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3N0ZG91dCcpO1xuICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJzdWNjZXNzIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIH0pOyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24peyBcbiAgICAgICAgICAgICAgcmVqZWN0KFwiZXJyb3IgaW4gcHJvbWlzZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICB9KTtcbiAgICByZXR1cm4gZmZtcGVnUHJvbWlzZS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3NNZXNzYWdlKXtcbiAgICAgICAgY29uc29sZS5sb2coc3VjY2Vzc01lc3NhZ2UpO1xuICAgICAgICBkb25lKCk7XG4gICAgXG4gICAgfSk7XG59KTtcbiAgICAgICBcbn0pO1xuIFxuXG5hcHAuZ2V0KCcvdGVzdCcsIChyZXEsIHJlcykgPT4ge1xuICAgIC8vZ2V0IHVybHNcbiAgICAvL2kgZXhlY3QgMiBwYXJhbXMgcmVmZXJlbmNlIHVybCByZWYsIHRlc3QgdXJsIHRlc3Rcblx0Ly9pIGV4cGVjdCAzIHBhcmFtZXRlcnMgcmVmZXJlbmNlIHVybCByZWYsIHRlc3QgdXJsIHRlc3QsIGFuZCBtb2JpbGUgbW9kZWxcbiAgICBsZXQgcmVmID0gcmVxLnF1ZXJ5LnJlZnVybDtcbiAgICBsZXQgdGVzdCA9IHJlcS5xdWVyeS50ZXN0dXJsO1xuICAgIGxldCBhcGkgPWZhbHNlO1xuXHRsZXQgbW9iaWxlID0gdHJ1ZTtcbiAgICBcblx0XG4gICAgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJmYWxzZVwiICl7XG4gICAgICAgYXBpID0gZmFsc2U7XG4gICAgfWVsc2UgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJ0cnVlXCIgKXtcbiAgICAgXHRhcGkgPSB0cnVlO1xuICAgIH1cbiBcbiAgICBpZiAocmVxLnF1ZXJ5Lm1vYmlsZW1vZGVsID09IFwib25cIiApe1xuICAgICBcdG1vYmlsZSA9IHRydWU7XG4gICAgfWVsc2V7IG1vYmlsZT1mYWxzZTt9XG5cdFxuICAgIGxldCB0ZXN0UHJpb3JpdHkgPSA1O1xuICAgIGlmIChyZXEucXVlcnkucHJpICE9PSB7fSl7XG4gICAgICB0ZXN0UHJpb3JpdHkgPSByZXEucXVlcnkucHJpO1xuICAgIH1cblxuICAgIC8vY29uc29sZS5sb2coXCJhcGk6IFwiICthcGkpO1xuICAgIC8vY3JlYXRlIHVuaXF1ZSBJRFxuICAgIGNvbnN0IGlkID0gdXVpZHY0KCk7XG4gICAgXG4gICAgLy9nZXQgZmZwcm9iZSBmb3JtYXQgZGF0YSBvZiBib3RoIGZpbGVzLCBhbmQgdGhlbiBydW4gdGhlIHZtYWYgY29tcGFyaXNvbiBcbiAgICB2YXIgdG90YWxKc29uID0gXCJcIjtcbiAgICB2YXIganNvbkNvbWJpbmVkUHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICBcdCAgICAgIFxuICBcdCAgICB0cnl7ICBcbiAgXHQgICAgICBmZnByb2JlKHJlZiwgZnVuY3Rpb24ocmVmcmVzdWx0KSB7IFxuICAgIFx0XHRmZnByb2JlKHRlc3QsIGZ1bmN0aW9uKHRlc3RyZXN1bHQpIHtcbiAgICBcdFx0XHQvL2NyZWF0ZSBjb21iaW5lZCBKU09OIGZpbGVcbiAgICBcdFx0XHR2YXIgY29tYmluZWRKc29uID0gXCJ7XFxcInRlc3RcXFwiOlwiKyB0ZXN0cmVzdWx0K1wiLFxcXCJyZWZlcmVuY2VcXFwiOlwiK3JlZnJlc3VsdCtcIixcXFwibW9iaWxlXFxcIjpcIittb2JpbGUrXCJ9XCJcbiAgICBcdFx0XHRyZXNvbHZlKGNvbWJpbmVkSnNvbik7XG4gICAgXHRcdH0pO1xuICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IFxuICAgICAgICAgIGNhdGNoKEV4Y2VwdGlvbil7XG4gICAgICAgICAgXHRyZWplY3QoXCJlcnJvciBpbiBmZnByb2JlIHByb21pc2VcIik7XG4gICAgICAgICAgfSAgIFxufSk7XG5cblxuXG5qc29uQ29tYmluZWRQcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgdG90YWxKc29uID0gdmFsdWU7XG4vLyAgY29uc29sZS5sb2coXCJ0b3RhbCBqc29uIHByb21pc2U6XCIrIHRvdGFsSnNvbik7XG4gICAvL2NvbXBhcmUgdGhlIDIgdmlkZW9zXG4gICAvL25vIGxvbmdlciBoYXZlIHRvIGJlIHRoZSBzYW1lIHNpemUhISFcbiAgIHBhcnNlZFRvdGFsSnNvbiA9IEpTT04ucGFyc2UodG90YWxKc29uKTtcbiAgIGNvbnNvbGUubG9nKHBhcnNlZFRvdGFsSnNvbik7XG4gICB2YXIgc3RyZWFtQ291bnQgPSBwYXJzZWRUb3RhbEpzb25bJ3JlZmVyZW5jZSddWydzdHJlYW1zJ10ubGVuZ3RoO1xuICAgdmFyIG1vYmlsZSA9IHBhcnNlZFRvdGFsSnNvblsnbW9iaWxlJ107XG4gICB2YXIgcmVmV2lkdGg9MDtcbiAgIHZhciByZWZIZWlnaHQgPSAwO1xuICAgdmFyIHRlc3RXaWR0aD0wO1xuICAgdmFyIHRlc3RIZWlnaHQgPSAwO1xuICAgZm9yKHZhciBpPTA7aTxzdHJlYW1Db3VudDtpKyspe1xuICAgXHRcdGlmIChwYXJzZWRUb3RhbEpzb25bJ3JlZmVyZW5jZSddWydzdHJlYW1zJ11baV1bJ2NvZGVjX3R5cGUnXSA9PVwidmlkZW9cIil7XG4gICBcdFx0ICAgcmVmV2lkdGggPSBwYXJzZWRUb3RhbEpzb25bJ3JlZmVyZW5jZSddWydzdHJlYW1zJ11baV1bJ3dpZHRoJ107XG4gICBcdFx0XHRyZWZIZWlnaHQgPXBhcnNlZFRvdGFsSnNvblsncmVmZXJlbmNlJ11bJ3N0cmVhbXMnXVtpXVsnaGVpZ2h0J107XG4gICBcdFx0XHRjb25zb2xlLmxvZyhcInJlZjogXCIrcmVmSGVpZ2h0ICsgXCIgeFwiICtyZWZXaWR0aCk7XG4gICBcdFx0fVxuICAgXHRcdGlmIChwYXJzZWRUb3RhbEpzb25bJ3Rlc3QnXVsnc3RyZWFtcyddW2ldWydjb2RlY190eXBlJ10gPT1cInZpZGVvXCIpe1xuICAgXHRcdCAgIHRlc3RXaWR0aCA9IHBhcnNlZFRvdGFsSnNvblsndGVzdCddWydzdHJlYW1zJ11baV1bJ3dpZHRoJ107XG4gICBcdFx0XHR0ZXN0SGVpZ2h0ID1wYXJzZWRUb3RhbEpzb25bJ3Rlc3QnXVsnc3RyZWFtcyddW2ldWydoZWlnaHQnXTtcbiAgIFx0XHRcdGNvbnNvbGUubG9nKFwidGVzdDogXCIrdGVzdEhlaWdodCArIFwiIHhcIiArdGVzdFdpZHRoKTtcbiAgIFx0XHR9XG4gICBcbiAgIH0gXG4gICBcbiAgIC8vY29uc29sZS5sb2coJ3JlZiB2aWRlbyBpcyAoaHh3KTonK3JlZkhlaWdodCtyZWZXaWR0aCk7XG4gICAvL2FkZCB2aWRlbyB0byB0aGUgcXVldWUgZm9yIHF1YWxpdHkgc2NvcmluZ1xuICBcbiAgIGNvbnN0IGpvYiA9IHZpZGVvUXVhbGl0eVF1ZXVlLmFkZCh7XG4gICAgIGZpbGVJRDogaWQsXG4gICAgIHRlc3RVcmw6IHRlc3QsIFxuICAgICByZWZVcmw6IHJlZixcblx0IG1vYmlsZTogbW9iaWxlLFxuICAgICByZWZWaWRlb0hlaWdodDogcmVmSGVpZ2h0LFxuICAgICByZWZWaWRlb1dpZHRoOiByZWZXaWR0aFxuICAgfSx7cHJpb3JpdHk6IHRlc3RQcmlvcml0eX0pO1xuICAgXG4gICBjb25zb2xlLmxvZyhcImZpbGVpZDpcIiAraWQgK1wibW9iaWxlXCIrbW9iaWxlKTtcbiAgICB0b3RhbEpzb24gPSBKU09OLnBhcnNlKHRvdGFsSnNvbik7XG4gICAgdmFyIHN0YXR1c0NvZGUgPSAxMDA7XG4gICAgaWYgKGFwaT09PXRydWUpe1xuXG4gICAgXHRjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIFx0XHRpZCwgc3RhdHVzQ29kZSwgcmVmSGVpZ2h0LCByZWZXaWR0aCx0ZXN0V2lkdGgsIHRlc3RIZWlnaHQsIHRvdGFsSnNvbiwgbW9iaWxlXG4gICAgXHR9O1xuICAgIFx0Ly9zZW5kIGEgMTAwIG1lYW5pbmcgdGhhdCB0aGUgdGVzdCBpcyBpbiBwcm9jZXNzXG4gICBcdFx0cmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJlc3BvbnNlKTtcbiAgIFx0fSBlbHNle1xuICAgXHRcdCAvL2J1aWxkIGEgcGFnZSBcdFx0IFxuICAgXHRcdCByZXR1cm4gcmVzLnJlbmRlcignaW5kZXgnLCB7XG4gIFx0XHRcdGlkLCBzdGF0dXNDb2RlLCByZWZIZWlnaHQsIHJlZldpZHRoLHRlc3RXaWR0aCwgdGVzdEhlaWdodCwgdG90YWxKc29uLCBtb2JpbGVcblx0XHQgfSk7XG4gICBcdFx0IFxuICAgXHRcdCB9XG4gIFxufSk7XG4gXG4gIFxuXG5cbn0pO1xuXG5hcHAuZ2V0KCcvdGVzdFJlc3VsdHMnLCAocmVxLCByZXMpID0+IHtcbiAgLy9pIGV4cGVjdCB0byBnZXQgdGhlIHV1aWQgdGhhdCBjb3JyZXNwb25kcyB0byBhZmlsZW5hbWVcbiAgbGV0IGlkID0gcmVxLnF1ZXJ5LmlkO1xuICAgICAgbGV0IGFwaSA9ZmFsc2U7XG4gICAgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJmYWxzZVwiICl7XG4gICAgICAgYXBpID0gZmFsc2U7XG4gICAgfWVsc2UgaWYgKHJlcS5xdWVyeS5hcGkgPT0gXCJ0cnVlXCIgKXtcbiAgICAgXHRhcGkgPSB0cnVlO1xuICAgIH1cbiAgbGV0IG1vYmlsZSA9IHJlcS5xdWVyeS5tb2JpbGU7XG4gIGNvbnNvbGUubG9nKFwibW9iaWxlIG1vZGVsOlwiICsgbW9iaWxlKTtcblx0XG4gIC8vZ2V0IHRoZSBkYXRhIHRoYXQgaXMgc3RvcmVkIG9uIHRoZSBzZXJ2ZXJcbiAgLy9xdWFsaXR5IGRhdGFcbiAgbGV0IGZpbGVuYW1lID0gXCJ0ZXN0X1wiICtpZCsgXCIuanNvblwiO1xuICB2YXIgcmVzdWx0O1xuICB0cnkge1xuICAgIHJlc3VsdCA9IGZzLnJlYWRGaWxlU3luYyhwYXRoICtmaWxlbmFtZSwgJ3V0ZjgnKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgIC8vIG5vIGZpbGUgZm91bmQgLSBub3QgcmVhZHkgeWV0XG4gICAgIHZhciBpblByb2dyZXNzID0gSlNPTi5wYXJzZShcIntcXFwic3RhdHVzQ29kZVxcXCI6IDEwMSwgXFxcInN0YXR1c1xcXCI6IFxcXCJTdGlsbCBwcm9jZXNzaW5nLiBUcnkgQWdhaW4gaW4gYSBmZXcgbWludXRlcy5cXFwifVwiKTtcbiAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKGluUHJvZ3Jlc3MpO1xuICB9XG5cbiAgdmFyIGpzb24gPSBKU09OLnBhcnNlKHJlc3VsdCk7XG4gIHZhciB2aWRlb2pzb24gPSBKU09OLnN0cmluZ2lmeShwYXJzZWRUb3RhbEpzb24pO1xuICBjb25zb2xlLmxvZyh2aWRlb2pzb24pO1xuICB2YXIgc3RhdHVzQ29kZSA9IDIwMDtcbiAgdmFyIFZNQUYgPSBqc29uWydWTUFGIHNjb3JlJ107XG4gIHZhciBQU05SID0ganNvblsnUFNOUiBzY29yZSddO1xuICB2YXIgU1NJTSA9IGpzb25bJ1NTSU0gc2NvcmUnXTtcbiAgdmFyIHJldHVybkpzb24gPSBcIntcXFwiVk1BRlxcXCI6XCIranNvblsnVk1BRiBzY29yZSddK1wiLCBcXFwiUFNOUlxcXCI6XCIranNvblsnUFNOUiBzY29yZSddK1wiLCBcXFwiU1NJTVxcXCI6XCIranNvblsnU1NJTSBzY29yZSddK1wiLCBcXFwibW9iaWxlXFxcIjpcIittb2JpbGUrXCJ9XCI7XG4gIHJldHVybkpzb24gPSBKU09OLnBhcnNlKHJldHVybkpzb24pO1xuICAvL2NvbnNvbGUubG9nKHJldHVybkpzb24pO1xuICB2YXIgc3RhdHVzQ29kZSA9IDIwMDtcbiAgaWYoYXBpKXtcbiAgICBjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIGlkLCBtb2JpbGUsc3RhdHVzQ29kZSxWTUFGLFBTTlIsU1NJTVxuICAgICB9O1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZChyZXNwb25zZSk7XG4gIH1lbHNle1xuICAgICAvL2J1aWxkIGEgcGFnZSBcdFx0IFxuICAgICByZXR1cm4gcmVzLnJlbmRlcigncmVzdWx0cycsIHtcbiAgXHRcdFx0aWQsIG1vYmlsZSxzdGF0dXNDb2RlLFZNQUYsUFNOUixTU0lNXG5cdCB9KTtcbiAgIFx0XHQgXG4gIH1cbiAgXG59KTtcblxuXG5hcHAubGlzdGVuKDE0MzcsICgpID0+XG4gIGNvbnNvbGUubG9nKGBSZWFkeSB0byBwcm9jZXNzIHZpZGVvIGZpbGVzIG9uIHBvcnQgMTQzNyFgKSxcbik7XG5cblxuZnVuY3Rpb24gZmZwcm9iZSh2aWRlb1VybCwgY2FsbGJhY2spe1xuXHR2YXIgZGF0YVN0cmluZyA9IFwiXCI7XG5cdGxldCBwcm9iZSA9IHNwYXduKCdmZnByb2JlJywgWyctaScsIHZpZGVvVXJsLCAnLXNob3dfZm9ybWF0JywnLXNob3dfc3RyZWFtcycsIGAtdmAsICdxdWlldCcsICctcHJpbnRfZm9ybWF0JywgJ2pzb24nXSk7XG4gICAgLy8gY29uc29sZS5sb2coXCJmZnByb2JlXCIgKyB2aWRlb1VybCk7XG4gICAgIHByb2JlLnN0ZG91dC5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgLy8gY29uc29sZS5sb2coXCJkZWJ1Z2dpbmcgRExcIiArZGF0YS5sZW5ndGgpOyAgICAgXHRcbiAgICAgICAgZGF0YVN0cmluZyArPSBkYXRhLnRvU3RyaW5nKCk7XG5cdFx0Y29uc29sZS5sb2coZGF0YVN0cmluZyk7XG4gXHR9KTtcbiBcdHByb2JlLm9uKCdjbG9zZScsIGZ1bmN0aW9uKGNvZGUpIHtcbiBcdFx0Ly9jb25zb2xlLmxvZyhcImNsb3NlOiBcIisgZGF0YVN0cmluZyk7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhkYXRhU3RyaW5nKTtcbiAgICB9KTtcblxufVxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "require",
        "cors",
        "express",
        "uuidv4",
        "pug",
        "Queue",
        "favicon",
        "app",
        "use",
        "json",
        "urlencoded",
        "extended",
        "set",
        "static",
        "fs",
        "get",
        "req",
        "res",
        "render",
        "url",
        "query",
        "console",
        "log",
        "probeJson",
        "Promise",
        "resolve",
        "reject",
        "ffprobe",
        "result",
        "resultJson",
        "Exception",
        "then",
        "value",
        "parsedprobeJson",
        "JSON",
        "parse",
        "status",
        "send",
        "path",
        "parsedTotalJson",
        "test",
        "spawn",
        "videoQualityQueue",
        "limiter",
        "max",
        "duration",
        "concurrency",
        "process",
        "job",
        "done",
        "jobString",
        "stringify",
        "file",
        "data",
        "fileID",
        "mobile",
        "ffmpegPromise",
        "params",
        "ffmpeg",
        "testUrl",
        "refUrl",
        "refVideoWidth",
        "refVideoHeight",
        "stderr",
        "on",
        "err",
        "String",
        "stdout",
        "successMessage",
        "ref",
        "refurl",
        "testurl",
        "api",
        "mobilemodel",
        "testPriority",
        "pri",
        "id",
        "totalJson",
        "jsonCombinedPromise",
        "refresult",
        "testresult",
        "combinedJson",
        "streamCount",
        "length",
        "refWidth",
        "refHeight",
        "testWidth",
        "testHeight",
        "i",
        "add",
        "priority",
        "statusCode",
        "response",
        "filename",
        "readFileSync",
        "inProgress",
        "videojson",
        "VMAF",
        "PSNR",
        "SSIM",
        "returnJson",
        "listen",
        "videoUrl",
        "callback",
        "dataString",
        "probe",
        "toString",
        "code"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/dougsillars/Documents/Github/StreamClarity/src",
      "sourcesContent": [
        "//https://www.robinwieruch.de/minimal-node-js-babel-setup\n//great node tutorial\n\n\nrequire('dotenv/config');\nconst cors = require('cors');\nconst express =require('express');\nconst uuidv4 =require('uuid/v4');\n\n//import cors from 'cors';\n//import express from 'express';\n//import uuidv4 from 'uuid/v4';\n\nconst pug = require('pug');\n//bull for queuing the vmaf ffmpeg jons\nvar Queue = require('bull');\nvar favicon = require('serve-favicon');\nconst app = express();\napp.use(favicon('public/icon.ico')); \napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\napp.set('view engine','pug');\napp.use(express.static('public/'));\n\n\n//read files\nvar fs = require('fs');\n//var http = require('http');\n//var https = require('https');\n\n\n\napp.get('/',  (req, res) => {\n     return res.render('landing');\n});\n\napp.get('/probe', (req,res) =>{\n\tlet url = req.query.url;\n\tconsole.log(\"testurl=\"+url);\n\tvar probeJson = new Promise(function(resolve, reject) {\n  \t      \n  \t    try{  \n  \t      ffprobe(url, function(result) { \n    \t\t\t//create combined JSON file\n    \t\t\tvar resultJson = result;\n    \t\t\t\n    \t\t\tresolve(resultJson);\n           });\n          } \n          catch(Exception){\n          \treject(\"error in ffprobe promise\");\n          }\n    });\n    probeJson.then(function(value) {\n//     console.log(\"total json promise:\"+ totalJson);\n     //compare the 2 videos\n     //no longer have to be the same size!!!\n       var parsedprobeJson = JSON.parse(value);\n       console.log(\"parsed json\" + value);\n       //const response = {parsedprobeJson};\n       return res.status(200).send(parsedprobeJson);\n   });\n   var path = \"../tests/\"\nvar parsedTotalJson=\"\";\nlet test= {};\nconst spawn = require('child_process').spawn;\n\n//create the video queue\n//queue allows 2 jobs at a time\nconst videoQualityQueue = new Queue('ffmpeg-processing-qualityMetrics', {\n  limiter: {\n    max: 1, \n    duration: 1000\n  }\n});\n\nconst concurrency = 1;\nvideoQualityQueue.process(concurrency, function(job, done) {\n    var jobString = JSON.stringify(job);\n    var file = \"test_\" +job.data.fileID+ \".json\";\n    console.log(path+file);\n\tconsole.log(\"mobile?\" +job.data.mobile);\n    var ffmpegPromise = new Promise(function(resolve, reject) {\n        var params = ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:phone_model=true:log_fmt=json:log_path=';\n        if(!job.data.mobile){\n          params = ':flags=bicubic[main];[main][1:v]libvmaf=ssim=true:psnr=true:log_fmt=json:log_path='\n        }\n        console.log(\"mobile: \" +job.data.mobile);\n        console.log(\"params: \" +params);\n            try {\n                  let ffmpeg = spawn('ffmpeg', ['-i', job.data.testUrl, '-i', job.data.refUrl, '-filter_complex', '[0:v]scale='+job.data.refVideoWidth+'x'+job.data.refVideoHeight+params+path+file, `-f`, 'null', '-']);\n                  console.log(\"running test id:\" +job.data.fileID); \n                  ffmpeg.stderr.on('data', (err) => {\n                        console.log('err:', new String(err));\n                        \n                  });\n                  ffmpeg.stdout.on('data', function(){ \n                      console.log('stdout');\n                      resolve(\"success!\");\n                      \n                  }); \n            }\n            catch (Exception){ \n              reject(\"error in promise\");\n            }\n          \n    });\n    return ffmpegPromise.then(function(successMessage){\n        console.log(successMessage);\n        done();\n    \n    });\n});\n       \n});\n \n\napp.get('/test', (req, res) => {\n    //get urls\n    //i exect 2 params reference url ref, test url test\n\t//i expect 3 parameters reference url ref, test url test, and mobile model\n    let ref = req.query.refurl;\n    let test = req.query.testurl;\n    let api =false;\n\tlet mobile = true;\n    \n\t\n    if (req.query.api == \"false\" ){\n       api = false;\n    }else if (req.query.api == \"true\" ){\n     \tapi = true;\n    }\n \n    if (req.query.mobilemodel == \"on\" ){\n     \tmobile = true;\n    }else{ mobile=false;}\n\t\n    let testPriority = 5;\n    if (req.query.pri !== {}){\n      testPriority = req.query.pri;\n    }\n\n    //console.log(\"api: \" +api);\n    //create unique ID\n    const id = uuidv4();\n    \n    //get ffprobe format data of both files, and then run the vmaf comparison \n    var totalJson = \"\";\n    var jsonCombinedPromise = new Promise(function(resolve, reject) {\n  \t      \n  \t    try{  \n  \t      ffprobe(ref, function(refresult) { \n    \t\tffprobe(test, function(testresult) {\n    \t\t\t//create combined JSON file\n    \t\t\tvar combinedJson = \"{\\\"test\\\":\"+ testresult+\",\\\"reference\\\":\"+refresult+\",\\\"mobile\\\":\"+mobile+\"}\"\n    \t\t\tresolve(combinedJson);\n    \t\t});\n           });\n          } \n          catch(Exception){\n          \treject(\"error in ffprobe promise\");\n          }   \n});\n\n\n\njsonCombinedPromise.then(function(value) {\n  totalJson = value;\n//  console.log(\"total json promise:\"+ totalJson);\n   //compare the 2 videos\n   //no longer have to be the same size!!!\n   parsedTotalJson = JSON.parse(totalJson);\n   console.log(parsedTotalJson);\n   var streamCount = parsedTotalJson['reference']['streams'].length;\n   var mobile = parsedTotalJson['mobile'];\n   var refWidth=0;\n   var refHeight = 0;\n   var testWidth=0;\n   var testHeight = 0;\n   for(var i=0;i<streamCount;i++){\n   \t\tif (parsedTotalJson['reference']['streams'][i]['codec_type'] ==\"video\"){\n   \t\t   refWidth = parsedTotalJson['reference']['streams'][i]['width'];\n   \t\t\trefHeight =parsedTotalJson['reference']['streams'][i]['height'];\n   \t\t\tconsole.log(\"ref: \"+refHeight + \" x\" +refWidth);\n   \t\t}\n   \t\tif (parsedTotalJson['test']['streams'][i]['codec_type'] ==\"video\"){\n   \t\t   testWidth = parsedTotalJson['test']['streams'][i]['width'];\n   \t\t\ttestHeight =parsedTotalJson['test']['streams'][i]['height'];\n   \t\t\tconsole.log(\"test: \"+testHeight + \" x\" +testWidth);\n   \t\t}\n   \n   } \n   \n   //console.log('ref video is (hxw):'+refHeight+refWidth);\n   //add video to the queue for quality scoring\n  \n   const job = videoQualityQueue.add({\n     fileID: id,\n     testUrl: test, \n     refUrl: ref,\n\t mobile: mobile,\n     refVideoHeight: refHeight,\n     refVideoWidth: refWidth\n   },{priority: testPriority});\n   \n   console.log(\"fileid:\" +id +\"mobile\"+mobile);\n    totalJson = JSON.parse(totalJson);\n    var statusCode = 100;\n    if (api===true){\n\n    \tconst response = {\n      \t\tid, statusCode, refHeight, refWidth,testWidth, testHeight, totalJson, mobile\n    \t};\n    \t//send a 100 meaning that the test is in process\n   \t\treturn res.status(200).send(response);\n   \t} else{\n   \t\t //build a page \t\t \n   \t\t return res.render('index', {\n  \t\t\tid, statusCode, refHeight, refWidth,testWidth, testHeight, totalJson, mobile\n\t\t });\n   \t\t \n   \t\t }\n  \n});\n \n  \n\n\n});\n\napp.get('/testResults', (req, res) => {\n  //i expect to get the uuid that corresponds to afilename\n  let id = req.query.id;\n      let api =false;\n    if (req.query.api == \"false\" ){\n       api = false;\n    }else if (req.query.api == \"true\" ){\n     \tapi = true;\n    }\n  let mobile = req.query.mobile;\n  console.log(\"mobile model:\" + mobile);\n\t\n  //get the data that is stored on the server\n  //quality data\n  let filename = \"test_\" +id+ \".json\";\n  var result;\n  try {\n    result = fs.readFileSync(path +filename, 'utf8');\n  } catch (err) {\n     // no file found - not ready yet\n     var inProgress = JSON.parse(\"{\\\"statusCode\\\": 101, \\\"status\\\": \\\"Still processing. Try Again in a few minutes.\\\"}\");\n     return res.status(200).send(inProgress);\n  }\n\n  var json = JSON.parse(result);\n  var videojson = JSON.stringify(parsedTotalJson);\n  console.log(videojson);\n  var statusCode = 200;\n  var VMAF = json['VMAF score'];\n  var PSNR = json['PSNR score'];\n  var SSIM = json['SSIM score'];\n  var returnJson = \"{\\\"VMAF\\\":\"+json['VMAF score']+\", \\\"PSNR\\\":\"+json['PSNR score']+\", \\\"SSIM\\\":\"+json['SSIM score']+\", \\\"mobile\\\":\"+mobile+\"}\";\n  returnJson = JSON.parse(returnJson);\n  //console.log(returnJson);\n  var statusCode = 200;\n  if(api){\n    const response = {\n      id, mobile,statusCode,VMAF,PSNR,SSIM\n     };\n    return res.status(200).send(response);\n  }else{\n     //build a page \t\t \n     return res.render('results', {\n  \t\t\tid, mobile,statusCode,VMAF,PSNR,SSIM\n\t });\n   \t\t \n  }\n  \n});\n\n\napp.listen(1437, () =>\n  console.log(`Ready to process video files on port 1437!`),\n);\n\n\nfunction ffprobe(videoUrl, callback){\n\tvar dataString = \"\";\n\tlet probe = spawn('ffprobe', ['-i', videoUrl, '-show_format','-show_streams', `-v`, 'quiet', '-print_format', 'json']);\n    // console.log(\"ffprobe\" + videoUrl);\n     probe.stdout.on('data', (data) => {\n       // console.log(\"debugging DL\" +data.length);     \t\n        dataString += data.toString();\n\t\tconsole.log(dataString);\n \t});\n \tprobe.on('close', function(code) {\n \t\t//console.log(\"close: \"+ dataString);\n        return callback(dataString);\n    });\n\n}\n"
      ]
    },
    "sourceType": "module",
    "mtime": 1628883064621
  }
}